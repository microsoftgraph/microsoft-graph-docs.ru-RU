---
title: Использование API Поиска (Майкрософт) для запросов данных
description: С помощью API поиска приложения могут искать данные Microsoft 365 в контексте пользователя, прошедшего проверку подлинности.
localization_priority: Priority
author: nmoreau
ms.prod: search
doc_type: resourcePageType
ms.openlocfilehash: b616119d1b5c1dcc8bb56b65711468cceafd7d88
ms.sourcegitcommit: 9f88b7e41a4a4a4d5f52bd995ce07c6f702bd5d6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2020
ms.locfileid: "49523009"
---
# <a name="use-the-microsoft-search-api-to-query-data"></a><span data-ttu-id="299dc-103">Использование API Поиска (Майкрософт) для запросов данных</span><span class="sxs-lookup"><span data-stu-id="299dc-103">Use the Microsoft Search API to query data</span></span>

<span data-ttu-id="299dc-104">Вы можете использовать API Поиска (Майкрософт) для запроса данных Microsoft 365 в своих приложениях.</span><span class="sxs-lookup"><span data-stu-id="299dc-104">You can use the Microsoft Search API to query Microsoft 365 data in your apps.</span></span>

<span data-ttu-id="299dc-105">Поисковые запросы выполняются в контексте вошедшего пользователя, указанного [маркером доступа с делегированными разрешениями](/graph/auth-v2-user).</span><span class="sxs-lookup"><span data-stu-id="299dc-105">Search requests run in the context of the signed-in user, identified using an [access token with delegated permissions](/graph/auth-v2-user).</span></span>

## <a name="common-use-cases"></a><span data-ttu-id="299dc-106">Основные варианты использования</span><span class="sxs-lookup"><span data-stu-id="299dc-106">Common use cases</span></span>

<span data-ttu-id="299dc-107">API Microsoft Search предоставляет метод [query](../api/search-query.md) для поиска по данным в Microsoft Search; в этот метод передается [searchRequest](searchRequest.md) в теле запроса, определяя характер поиска.</span><span class="sxs-lookup"><span data-stu-id="299dc-107">The Microsoft Search API provides a [query](../api/search-query.md) method to search across your data in Microsoft Search, where you pass a [searchRequest](searchRequest.md) in the request body, defining the specifics of your search.</span></span>

<span data-ttu-id="299dc-108">В этом разделе перечислены распространенные варианты использования метода **query** с применением свойств и параметров, заданных в тексте запроса **query** [searchRequest](searchRequest.md).</span><span class="sxs-lookup"><span data-stu-id="299dc-108">This section lists the common use cases of the **query** method, based on the properties and parameters you set in the **query** [searchRequest](searchRequest.md) body.</span></span>

<span data-ttu-id="299dc-109">Поисковые запросы выполняются от имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="299dc-109">Search requests run on behalf of the user.</span></span> <span data-ttu-id="299dc-110">Результаты поиска ограничиваются для применения правил контроля доступа к элементам.</span><span class="sxs-lookup"><span data-stu-id="299dc-110">Search results are scoped to enforce any access control applied to the items.</span></span>  <span data-ttu-id="299dc-111">Например, в контексте файлов разрешения для них оцениваются в составе поискового запроса.</span><span class="sxs-lookup"><span data-stu-id="299dc-111">For example, in the context of files, permissions on the files are evaluated as part of the search request.</span></span> <span data-ttu-id="299dc-112">Пользователь не может обратиться в результатах поиска к большему количеству элементов, чем он мог бы получить из соответствующей операции GET с теми же разрешениями и управлением доступом.</span><span class="sxs-lookup"><span data-stu-id="299dc-112">Users cannot access more items in a search than they can otherwise obtain from a corresponding GET operation with the same permissions and access control.</span></span>

| <span data-ttu-id="299dc-113">Варианты использования</span><span class="sxs-lookup"><span data-stu-id="299dc-113">Use cases</span></span> | <span data-ttu-id="299dc-114">Свойства, определяемые в тексте запроса query</span><span class="sxs-lookup"><span data-stu-id="299dc-114">Properties to define in the query request body</span></span> |
|:------------------|:---------|
|[<span data-ttu-id="299dc-115">Результаты поиска в области по типам объектов</span><span class="sxs-lookup"><span data-stu-id="299dc-115">Scope search results based on entity types</span></span>](#scope-search-based-on-entity-types)| <span data-ttu-id="299dc-116">**entityTypes**</span><span class="sxs-lookup"><span data-stu-id="299dc-116">**entityTypes**</span></span> |
|[<span data-ttu-id="299dc-117">Результаты со страницы</span><span class="sxs-lookup"><span data-stu-id="299dc-117">Page results</span></span>](#page-search-results) | <span data-ttu-id="299dc-118">**from** и **size**</span><span class="sxs-lookup"><span data-stu-id="299dc-118">**from** and **size**</span></span> |
|[<span data-ttu-id="299dc-119">Получение наиболее релевантных электронных писем</span><span class="sxs-lookup"><span data-stu-id="299dc-119">Get the most relevant emails</span></span>](#get-the-most-relevant-emails) | <span data-ttu-id="299dc-120">**enableTopResults**</span><span class="sxs-lookup"><span data-stu-id="299dc-120">**enableTopResults**</span></span> |
|[<span data-ttu-id="299dc-121">Получение выбранных свойств</span><span class="sxs-lookup"><span data-stu-id="299dc-121">Get selected properties</span></span>](#get-selected-properties) | <span data-ttu-id="299dc-122">**fields**</span><span class="sxs-lookup"><span data-stu-id="299dc-122">**fields**</span></span> |
|[<span data-ttu-id="299dc-123">Использование KQL в терминах запросов</span><span class="sxs-lookup"><span data-stu-id="299dc-123">Use KQL in query terms</span></span>](#keyword-query-language-kql-support) | <span data-ttu-id="299dc-124">**query**</span><span class="sxs-lookup"><span data-stu-id="299dc-124">**query**</span></span> |

## <a name="scope-search-based-on-entity-types"></a><span data-ttu-id="299dc-125">Поиск в области по типам объектов</span><span class="sxs-lookup"><span data-stu-id="299dc-125">Scope search based on entity types</span></span>

<span data-ttu-id="299dc-126">Область действия поискового запроса определяется с помощью свойства **entityTypes** полезных данных запроса **query**.</span><span class="sxs-lookup"><span data-stu-id="299dc-126">Define the scope of the search request using the **entityTypes** property in the **query** request payload.</span></span>
<span data-ttu-id="299dc-127">В следующей таблице описаны доступные типы запросов и поддерживаемые разрешения на доступ к данным.</span><span class="sxs-lookup"><span data-stu-id="299dc-127">The following table describes the types available to query and the supported permissions to access the data.</span></span>

| <span data-ttu-id="299dc-128">EntityType</span><span class="sxs-lookup"><span data-stu-id="299dc-128">EntityType</span></span> | <span data-ttu-id="299dc-129">Область разрешений, необходимая для доступа к элементам</span><span class="sxs-lookup"><span data-stu-id="299dc-129">Permission scope required to access the items</span></span>| <span data-ttu-id="299dc-130">Источник</span><span class="sxs-lookup"><span data-stu-id="299dc-130">Source</span></span>| <span data-ttu-id="299dc-131">Примечание</span><span class="sxs-lookup"><span data-stu-id="299dc-131">Comment</span></span>|
|:------------------|:---------|:---------|:---------|
|[<span data-ttu-id="299dc-132">message</span><span class="sxs-lookup"><span data-stu-id="299dc-132">message</span></span>](message.md)|<span data-ttu-id="299dc-133">Mail.Read, Mail.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="299dc-133">Mail.Read, Mail.ReadWrite</span></span>| <span data-ttu-id="299dc-134">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="299dc-134">Exchange Online</span></span>| <span data-ttu-id="299dc-135">Сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="299dc-135">Email messages.</span></span>|
|[<span data-ttu-id="299dc-136">event</span><span class="sxs-lookup"><span data-stu-id="299dc-136">event</span></span>](event.md) |<span data-ttu-id="299dc-137">Calendars.Read, Calendars.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="299dc-137">Calendars.Read, Calendars.ReadWrite</span></span>| <span data-ttu-id="299dc-138">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="299dc-138">Exchange Online</span></span>|<span data-ttu-id="299dc-139">События календаря.</span><span class="sxs-lookup"><span data-stu-id="299dc-139">Calendar events.</span></span> |
|[<span data-ttu-id="299dc-140">drive</span><span class="sxs-lookup"><span data-stu-id="299dc-140">drive</span></span>](drive.md)|<span data-ttu-id="299dc-141">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="299dc-141">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="299dc-142">SharePoint</span><span class="sxs-lookup"><span data-stu-id="299dc-142">SharePoint</span></span> | <span data-ttu-id="299dc-143">Библиотеки документов.</span><span class="sxs-lookup"><span data-stu-id="299dc-143">Document libraries.</span></span>|
|[<span data-ttu-id="299dc-144">driveItem</span><span class="sxs-lookup"><span data-stu-id="299dc-144">driveItem</span></span>](driveitem.md)|<span data-ttu-id="299dc-145">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="299dc-145">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="299dc-146">SharePoint и OneDrive</span><span class="sxs-lookup"><span data-stu-id="299dc-146">SharePoint and OneDrive</span></span> | <span data-ttu-id="299dc-147">Файлы, папки, страницы и новости.</span><span class="sxs-lookup"><span data-stu-id="299dc-147">Files, folders, pages, and news.</span></span> |
|[<span data-ttu-id="299dc-148">list</span><span class="sxs-lookup"><span data-stu-id="299dc-148">list</span></span>](list.md)|<span data-ttu-id="299dc-149">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="299dc-149">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="299dc-150">SharePoint и OneDrive</span><span class="sxs-lookup"><span data-stu-id="299dc-150">SharePoint and OneDrive</span></span> | <span data-ttu-id="299dc-151">Списки</span><span class="sxs-lookup"><span data-stu-id="299dc-151">Lists.</span></span> <span data-ttu-id="299dc-152">Учтите, что библиотеки документов также возвращаются как списки.</span><span class="sxs-lookup"><span data-stu-id="299dc-152">Note that document libraries are also returned as lists.</span></span> |
|[<span data-ttu-id="299dc-153">listItem</span><span class="sxs-lookup"><span data-stu-id="299dc-153">listItem</span></span>](listitem.md)|<span data-ttu-id="299dc-154">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="299dc-154">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="299dc-155">SharePoint и OneDrive</span><span class="sxs-lookup"><span data-stu-id="299dc-155">SharePoint and OneDrive</span></span> | <span data-ttu-id="299dc-156">Элементы списка.</span><span class="sxs-lookup"><span data-stu-id="299dc-156">List items.</span></span> <span data-ttu-id="299dc-157">Учтите, что файлы и папки также возвращаются как элементы списка; **listItem** — это суперкласс **driveItem**.</span><span class="sxs-lookup"><span data-stu-id="299dc-157">Note that files and folders are also returned as list items; **listItem** is the super class of **driveItem**.</span></span> |
|[<span data-ttu-id="299dc-158">site</span><span class="sxs-lookup"><span data-stu-id="299dc-158">site</span></span>](site.md)|<span data-ttu-id="299dc-159">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="299dc-159">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="299dc-160">SharePoint</span><span class="sxs-lookup"><span data-stu-id="299dc-160">SharePoint</span></span> | <span data-ttu-id="299dc-161">Сайты в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="299dc-161">Sites in SharePoint.</span></span>|

## <a name="page-search-results"></a><span data-ttu-id="299dc-162">Результаты поиска на странице</span><span class="sxs-lookup"><span data-stu-id="299dc-162">Page search results</span></span>

<span data-ttu-id="299dc-163">Управляйте разбивкой результатов поиска на страницы, указав описанные ниже два свойства в тексте запроса **query**.</span><span class="sxs-lookup"><span data-stu-id="299dc-163">Control pagination of the search results by specifying the following two properties in the **query** request body:</span></span>

- <span data-ttu-id="299dc-164">**from** — целое значение, указывающее начальную точку (начиная с 0) для перечисления результатов поиска на странице.</span><span class="sxs-lookup"><span data-stu-id="299dc-164">**from** - An integer that indicates the 0-based starting point to list search results on the page.</span></span> <span data-ttu-id="299dc-165">Значение по умолчанию равно 0.</span><span class="sxs-lookup"><span data-stu-id="299dc-165">The default value is 0.</span></span>

- <span data-ttu-id="299dc-166">**size** — целое число, обозначающее количество результатов, возвращаемых для страницы.</span><span class="sxs-lookup"><span data-stu-id="299dc-166">**size** - An integer that indicates the number of results to be returned for a page.</span></span> <span data-ttu-id="299dc-167">Значение по умолчанию: 25.</span><span class="sxs-lookup"><span data-stu-id="299dc-167">The default value is 25.</span></span>

<span data-ttu-id="299dc-168">При поиске объекта **event** или **message** учитывайте указанные ниже ограничения.</span><span class="sxs-lookup"><span data-stu-id="299dc-168">Note the following limits if you're searching the **event** or **message** entity:</span></span>

- <span data-ttu-id="299dc-169">Значение **from** должно начинаться с нуля для запроса первой страницы. В противном случае запрос возвращает ошибку HTTP 400 `Bad request`.</span><span class="sxs-lookup"><span data-stu-id="299dc-169">**from** must start at zero in the first page request; otherwise, the request results in an HTTP 400 `Bad request`.</span></span>
- <span data-ttu-id="299dc-170">Максимальное количество результатов на странице (**size**) составляет 25 для **message** и **event**..</span><span class="sxs-lookup"><span data-stu-id="299dc-170">The maximum results per page (**size**) is 25 for **message** and **event**.</span></span> 

<span data-ttu-id="299dc-171">Для SharePoint и OneDrive ограничений нет.</span><span class="sxs-lookup"><span data-stu-id="299dc-171">There is no upper limit for SharePoint or OneDrive items.</span></span> <span data-ttu-id="299dc-172">Рекомендуемый размер страницы — 200.</span><span class="sxs-lookup"><span data-stu-id="299dc-172">A reasonable page size is 200.</span></span> <span data-ttu-id="299dc-173">Чем больше размер страницы, тем, как правило, больше задержка.</span><span class="sxs-lookup"><span data-stu-id="299dc-173">A larger page size generally incurs higher latency.</span></span>

<span data-ttu-id="299dc-174">Рекомендации:</span><span class="sxs-lookup"><span data-stu-id="299dc-174">Best practices:</span></span>

- <span data-ttu-id="299dc-175">В исходном запросе задайте меньший размер первой страницы.</span><span class="sxs-lookup"><span data-stu-id="299dc-175">Specify a smaller first page in the initial request.</span></span> <span data-ttu-id="299dc-176">Например, задайте для свойства **from** значение 0, а для свойства **size** — 25.</span><span class="sxs-lookup"><span data-stu-id="299dc-176">For example, specify **from** as 0, **size** as 25.</span></span>
- <span data-ttu-id="299dc-177">Для получения последующих страниц обновите свойства **from** и **size**.</span><span class="sxs-lookup"><span data-stu-id="299dc-177">Paginate subsequent pages by updating the **from** and **size** properties.</span></span> <span data-ttu-id="299dc-178">Вы можете увеличивать размер страницы в каждом последующем запросе.</span><span class="sxs-lookup"><span data-stu-id="299dc-178">You can increase the page size in each subsequent request.</span></span> <span data-ttu-id="299dc-179">В приведенной ниже таблице показан пример.</span><span class="sxs-lookup"><span data-stu-id="299dc-179">The following table shows an example.</span></span>

    | <span data-ttu-id="299dc-180">Страница</span><span class="sxs-lookup"><span data-stu-id="299dc-180">Page</span></span> | <span data-ttu-id="299dc-181">from</span><span class="sxs-lookup"><span data-stu-id="299dc-181">from</span></span> | <span data-ttu-id="299dc-182">size</span><span class="sxs-lookup"><span data-stu-id="299dc-182">size</span></span> |
    |:-----|:-----|:-----|
    | <span data-ttu-id="299dc-183">1</span><span class="sxs-lookup"><span data-stu-id="299dc-183">1</span></span>    | <span data-ttu-id="299dc-184">0</span><span class="sxs-lookup"><span data-stu-id="299dc-184">0</span></span> | <span data-ttu-id="299dc-185">25</span><span class="sxs-lookup"><span data-stu-id="299dc-185">25</span></span> |
    | <span data-ttu-id="299dc-186">2</span><span class="sxs-lookup"><span data-stu-id="299dc-186">2</span></span>    | <span data-ttu-id="299dc-187">25</span><span class="sxs-lookup"><span data-stu-id="299dc-187">25</span></span> | <span data-ttu-id="299dc-188">50</span><span class="sxs-lookup"><span data-stu-id="299dc-188">50</span></span> |
    | <span data-ttu-id="299dc-189">3</span><span class="sxs-lookup"><span data-stu-id="299dc-189">3</span></span>    | <span data-ttu-id="299dc-190">75</span><span class="sxs-lookup"><span data-stu-id="299dc-190">75</span></span> | <span data-ttu-id="299dc-191">75</span><span class="sxs-lookup"><span data-stu-id="299dc-191">75</span></span> |
    | <span data-ttu-id="299dc-192">4</span><span class="sxs-lookup"><span data-stu-id="299dc-192">4</span></span>    | <span data-ttu-id="299dc-193">150</span><span class="sxs-lookup"><span data-stu-id="299dc-193">150</span></span> | <span data-ttu-id="299dc-194">100</span><span class="sxs-lookup"><span data-stu-id="299dc-194">100</span></span> |

## <a name="get-the-most-relevant-emails"></a><span data-ttu-id="299dc-195">Получение наиболее релевантных электронных писем</span><span class="sxs-lookup"><span data-stu-id="299dc-195">Get the most relevant emails</span></span>

<span data-ttu-id="299dc-196">Если при поиске объекта **message** задать для свойства **enableTopResults** значение `true`, возвращается гибридный список сообщений: первые три сообщения в отклике сортируются по релевантности, а остальные — по дате/времени.</span><span class="sxs-lookup"><span data-stu-id="299dc-196">When searching the **message** entity, specifying **enableTopResults** as `true` returns a hybrid list of messages: the first three messages in the response are sorted by relevance; the remaining messages are sorted by date/time.</span></span>

## <a name="get-selected-properties"></a><span data-ttu-id="299dc-197">Получение выбранных свойств</span><span class="sxs-lookup"><span data-stu-id="299dc-197">Get selected properties</span></span>

<span data-ttu-id="299dc-198">При поиске по типу сущности, например **message**, **event**, **drive**, **driveItem**, **list**, **listItem**, **site**, **externalItem**, можно включить в свойство **itfields** определенные свойства сущности, которые следует возвратить в результатах поиска.</span><span class="sxs-lookup"><span data-stu-id="299dc-198">When searching an entity type, such as **message**, **event**, **drive**, **driveItem**, **list**, **listItem**, **site**, **externalItem**, you can include in the **fields** property specific entity properties to return in the search results.</span></span> <span data-ttu-id="299dc-199">Аналогично используется [параметр $select системного запроса OData](/graph/query-parameters#select-parameter) в запросах REST.</span><span class="sxs-lookup"><span data-stu-id="299dc-199">This is similar to using the [OData system query option, $select](/graph/query-parameters#select-parameter) in REST requests.</span></span> <span data-ttu-id="299dc-200">API поиска не поддерживает эти параметры запроса, так как их действие подавляется в теле запроса POST.</span><span class="sxs-lookup"><span data-stu-id="299dc-200">The search API does not technically support these query options because the behavior is expressed in the POST body.</span></span>

<span data-ttu-id="299dc-201">Для всех этих типов сущностей указание свойства **fields** сокращает количество свойств, возвращаемых в отклике, что оптимизирует нагрузку на линию.</span><span class="sxs-lookup"><span data-stu-id="299dc-201">For all these entity types, specifying the **fields** property reduces the number of properties returned in the response, optimizing the payload over the wire.</span></span>

<span data-ttu-id="299dc-202">**listItem** и **externalItem** — единственные поддерживаемые сущности, которые позволяют настройку расширенных полей в схеме.</span><span class="sxs-lookup"><span data-stu-id="299dc-202">The **listItem** and **externalItem** entities are the only supported entities that allow getting extended fields configured in the schema.</span></span> <span data-ttu-id="299dc-203">Из всех других сущностей расширенные свойства невозможно получить.</span><span class="sxs-lookup"><span data-stu-id="299dc-203">You cannot retrieve extended properties from all the other entities.</span></span> <span data-ttu-id="299dc-204">Например, если имеется поле для **externalItem** в схеме поиска или пользовательский столбец в **listItem**, можно получит эти свойства из результатов поиска.</span><span class="sxs-lookup"><span data-stu-id="299dc-204">For example, if you created a field for **externalItem** in the search schema, or if you have a custom column on a **listItem**, you can retrieve these properties from search.</span></span> <span data-ttu-id="299dc-205">Чтобы получить расширенное свойство файла, укажите в запросе тип **listItem**.</span><span class="sxs-lookup"><span data-stu-id="299dc-205">To retrieve an extended property on a file, specify the **listItem** type in the request.</span></span>

<span data-ttu-id="299dc-206">Если поля, указанные в свойстве **fields**, отсутствуют в схеме, они не будут возвращены в отклике.</span><span class="sxs-lookup"><span data-stu-id="299dc-206">If the **fields** specified in the request are not present in the schema, they will not be returned in the response.</span></span> <span data-ttu-id="299dc-207">Недопустимые поля в запросе игнорируются без уведомления.</span><span class="sxs-lookup"><span data-stu-id="299dc-207">Invalid fields in the request are silently ignored.</span></span>

<span data-ttu-id="299dc-208">Если в запросе отсутствуют поля, указанные в свойстве **fields**, вы получите набор свойств для всех типов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="299dc-208">If you do not specify any **fields** in the request,  you will get the default set of properties for all types.</span></span> <span data-ttu-id="299dc-209">При использовании расширенных свойств **listItem** и **externalItem** ведут себя иначе, если поля, указанные в свойстве **fields**, не переданы в запрос.</span><span class="sxs-lookup"><span data-stu-id="299dc-209">For extended properties, **listItem** and **externalItem** behave differently when no **fields** are passed in the request:</span></span>

- <span data-ttu-id="299dc-210">**listItem** не возвращает никаких настраиваемых полей.</span><span class="sxs-lookup"><span data-stu-id="299dc-210">**listItem** will not return any custom field.</span></span>
- <span data-ttu-id="299dc-211">**externalItem** возвращает все поля с атрибутом **retrievable** в схеме соединителя Microsoft Graph для этого конкретного подключения.</span><span class="sxs-lookup"><span data-stu-id="299dc-211">**externalItem** will return all the fields marked with the **retrievable** attribute in the Microsoft Graph connector schema for that particular connection.</span></span>

## <a name="keyword-query-language-kql-support"></a><span data-ttu-id="299dc-212">Поддержка языка KQL</span><span class="sxs-lookup"><span data-stu-id="299dc-212">Keyword Query Language (KQL) support</span></span>

<span data-ttu-id="299dc-213">Вы можете указать произвольный текст ключевых слов (например, `AND` и `OR`) и ограничения свойств в синтаксисе KQL в фактической строке поискового запроса (свойства **query** в тексте запроса **query**).</span><span class="sxs-lookup"><span data-stu-id="299dc-213">Specify free text keywords, operators (such as `AND`, `OR`), and property restrictions in KQL syntax in the actual search query string (**query** property of the **query** request body).</span></span> <span data-ttu-id="299dc-214">Синтаксис и команда зависят от типов объектов (в свойстве **entityTypes**), указанных в тексте того же запроса **query**.</span><span class="sxs-lookup"><span data-stu-id="299dc-214">The syntax and command depend on the entity types (in the **entityTypes** property) you target in the same **query** request body.</span></span>

<span data-ttu-id="299dc-215">Свойства, доступные для поиска, зависят от типа объекта.</span><span class="sxs-lookup"><span data-stu-id="299dc-215">Depending on the entity type, the searchable properties vary.</span></span> <span data-ttu-id="299dc-216">Дополнительные сведения см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="299dc-216">For details, see:</span></span>

- [<span data-ttu-id="299dc-217">Свойства электронной почты</span><span class="sxs-lookup"><span data-stu-id="299dc-217">Email properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-email-properties)
- [<span data-ttu-id="299dc-218">Свойства сайта</span><span class="sxs-lookup"><span data-stu-id="299dc-218">Site properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-site-properties)

## <a name="error-handling"></a><span data-ttu-id="299dc-219">Обработка ошибок</span><span class="sxs-lookup"><span data-stu-id="299dc-219">Error handling</span></span>

<span data-ttu-id="299dc-220">API поиска возвращает отклики с ошибками, описанные в [определении объектов ошибок OData](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse), каждый из которых представляет собой объект JSON, содержащий код и сообщение.</span><span class="sxs-lookup"><span data-stu-id="299dc-220">The search API returns error responses as defined by [OData error object definition](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse), each of which is a JSON object containing a code and a message.</span></span>

<!---TODOSEARCHAPI Describe the know errors: bad requests.--->

## <a name="known-limitations"></a><span data-ttu-id="299dc-221">Известные ограничения</span><span class="sxs-lookup"><span data-stu-id="299dc-221">Known limitations</span></span>

<span data-ttu-id="299dc-222">На API поиска распространяются описанные ниже ограничения.</span><span class="sxs-lookup"><span data-stu-id="299dc-222">The search API has the following limitations:</span></span>

- <span data-ttu-id="299dc-223">Метод **query** определяется, чтобы разрешить передачу коллекции из одного или нескольких экземпляров **searchRequest**.</span><span class="sxs-lookup"><span data-stu-id="299dc-223">The **query** method is defined to allow passing a collection of one or more **searchRequest** instances at once.</span></span> <span data-ttu-id="299dc-224">Однако в настоящее время служба может обрабатывать только по одному экземпляру [searchRequest](./searchrequest.md) за раз.</span><span class="sxs-lookup"><span data-stu-id="299dc-224">However, the service currently supports only a single [searchRequest](./searchrequest.md) at a time.</span></span>

- <span data-ttu-id="299dc-225">Ресурс [searchRequest](./searchrequest.md) поддерживает одновременную передачу объектов нескольких типов.</span><span class="sxs-lookup"><span data-stu-id="299dc-225">The [searchRequest](./searchrequest.md) resource supports passing multiple types of entities at a time.</span></span> <span data-ttu-id="299dc-226">Однако в настоящее время поддерживается только следующее сочетание для типов объектов SharePoint и OneDrive: **driveItem**, **drive**, **site**, **list**, **listItem**.</span><span class="sxs-lookup"><span data-stu-id="299dc-226">However, currently the only supported combination is for SharePoint and OneDrive entityTypes: **driveItem**, **drive**, **site**, **list**, **listItem**.</span></span>
<span data-ttu-id="299dc-227">Любые сочетания, включающие **message**, **event**, типы SharePoint и OneDrive или **externalItem**, пока не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="299dc-227">Any combinations involving **message**, **event**, SharePoint and OneDrive types , or **externalItem** are currently not supported.</span></span>  

- <span data-ttu-id="299dc-228">Свойство **contentSource**, которое определяет используемое соединение, применимо, только если для свойства **entityType** задано значение `externalItem`.</span><span class="sxs-lookup"><span data-stu-id="299dc-228">The **contentSource** property, which defines the connection to use, is only applicable when **entityType** is specified as `externalItem`.</span></span>

- <span data-ttu-id="299dc-229">API поиска не поддерживает настраиваемую сортировку для **message**, **event** или **externalItem**.</span><span class="sxs-lookup"><span data-stu-id="299dc-229">The search API does not support custom sort for **message**, **event** or  **externalItem**.</span></span>

- <span data-ttu-id="299dc-230">API поиска не поддерживает агрегаты для **message**, **event**, **site** или **drive**.</span><span class="sxs-lookup"><span data-stu-id="299dc-230">The search API does not support aggregations for **message**, **event**, **site** or **drive**.</span></span>

## <a name="search-samples"></a><span data-ttu-id="299dc-231">Примеры поиска</span><span class="sxs-lookup"><span data-stu-id="299dc-231">Search samples</span></span>

- <span data-ttu-id="299dc-232">Подробнее о некоторых основных вариантах использования:</span><span class="sxs-lookup"><span data-stu-id="299dc-232">Learn more about a few key use cases:</span></span>
  - [<span data-ttu-id="299dc-233">Поиск сообщений Outlook</span><span class="sxs-lookup"><span data-stu-id="299dc-233">Search Outlook messages</span></span>](/graph/search-concept-messages)
  - [<span data-ttu-id="299dc-234">Поиск событий календаря</span><span class="sxs-lookup"><span data-stu-id="299dc-234">Search calendar events</span></span>](/graph/search-concept-events)
  - [<span data-ttu-id="299dc-235">Поиск содержимого в OneDrive и SharePoint</span><span class="sxs-lookup"><span data-stu-id="299dc-235">Search content in SharePoint and OneDrive</span></span>](/graph/search-concept-files)

- <span data-ttu-id="299dc-236">Узнайте больше об API в [песочнице Graph](https://developer.microsoft.com/graph/graph-explorer).</span><span class="sxs-lookup"><span data-stu-id="299dc-236">Explore the search APIs in  [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).</span></span>


## <a name="whats-new"></a><span data-ttu-id="299dc-237">Новые возможности</span><span class="sxs-lookup"><span data-stu-id="299dc-237">What's new</span></span>

<span data-ttu-id="299dc-238">Узнайте о [новых функциях и обновлениях](/graph/whats-new-overview) для этого набора API.</span><span class="sxs-lookup"><span data-stu-id="299dc-238">Find out about the [latest new features and updates](/graph/whats-new-overview) for this API set.</span></span>
