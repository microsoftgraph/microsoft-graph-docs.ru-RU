---
title: Упорядочение сообщений Outlook
description: В Outlook пользователи могут упорядочивать свои сообщения по собственному усмотрению. Можно оставить все сообщения в одной папке "Входящие" или упорядочить их в древовидной структуре вложенных папок в соответствии со своими потребностями. Вы можете легко фильтровать, искать и сортировать сообщения во всем
author: abheek-das
localization_priority: Priority
ms.prod: outlook
ms.openlocfilehash: b9359a380547caa27e093df41195e079f0bf7f1a
ms.sourcegitcommit: d014f72cf2cd130bedb02651092c0be12967b679
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "50474675"
---
# <a name="organize-outlook-messages"></a><span data-ttu-id="1a1be-104">Упорядочение сообщений Outlook</span><span class="sxs-lookup"><span data-stu-id="1a1be-104">Organize Outlook messages</span></span>

<span data-ttu-id="1a1be-105">В Outlook пользователи могут упорядочивать свои сообщения по собственному усмотрению. Можно оставить все сообщения в одной папке "Входящие" или упорядочить их в древовидной структуре вложенных папок в соответствии со своими потребностями.</span><span class="sxs-lookup"><span data-stu-id="1a1be-105">Outlook lets customers organize their messages the way they like it, be it leaving all messages in the same Inbox folder, or organizing messages in a tree-like folder structure under the Inbox to fit their specific needs.</span></span> <span data-ttu-id="1a1be-106">Вы можете легко [фильтровать, искать и сортировать](query-parameters.md) сообщения во всем почтовом ящике пользователя или в определенных папках.</span><span class="sxs-lookup"><span data-stu-id="1a1be-106">You can conveniently [filter, search, or sort](query-parameters.md) messages in the user's entire mailbox or in specific folders.</span></span>

## <a name="accessing-mail-folders"></a><span data-ttu-id="1a1be-107">Доступ к почтовым папкам</span><span class="sxs-lookup"><span data-stu-id="1a1be-107">Accessing mail folders</span></span>

<span data-ttu-id="1a1be-108">Программно папки сообщений представляются ресурсом [mailFolder](/graph/api/resources/mailfolder?view=graph-rest-1.0), а папка "Входящие" является одним из корневых элементов структуры папок.</span><span class="sxs-lookup"><span data-stu-id="1a1be-108">Programmatically, message folders are represented by the [mailFolder](/graph/api/resources/mailfolder?view=graph-rest-1.0) resource, and the Inbox is one of the folders at the root of the folder structure.</span></span>

<span data-ttu-id="1a1be-109">Каждый объект **mailFolder** указывается по идентификатору папки и содержит записываемое свойство **displayName**.</span><span class="sxs-lookup"><span data-stu-id="1a1be-109">Each **mailFolder** is identified by its folder ID, and has a writable **displayName** property.</span></span> <span data-ttu-id="1a1be-110">По умолчанию Outlook создает для пользователей еще несколько папок.</span><span class="sxs-lookup"><span data-stu-id="1a1be-110">Outlook creates a few other folders for customers by default.</span></span> <span data-ttu-id="1a1be-111">Вы можете ссылаться на эти стандартные папки по их идентификаторам или известным именам.</span><span class="sxs-lookup"><span data-stu-id="1a1be-111">You can reference these default folders by their folder IDs, or by their well-known names.</span></span> <span data-ttu-id="1a1be-112">Список доступных известных имен см. в статье [Тип ресурса mailFolder](/graph/api/resources/mailfolder?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="1a1be-112">For a list of available well-known folder names, see [mailFolder resource type](/graph/api/resources/mailfolder?view=graph-rest-1.0).</span></span>

<span data-ttu-id="1a1be-113">Зная путь к нестандартной папке, вы можете получить доступ и к ней. Для этого используйте сокращение `/users/{id}/mailfolders`, чтобы перейти на корневой уровень и получить все папки верхнего уровня:</span><span class="sxs-lookup"><span data-stu-id="1a1be-113">For a custom, non-default folder, if you know its folder path, you can access the folder by first using the `/users/{id}/mailfolders` shortcut to get to the root level and get all the top level folders:</span></span>

```http
GET https://graph.microsoft.com/v1.0/users/{id}/mailFolders
```

<span data-ttu-id="1a1be-114">Затем укажите соответствующий идентификатор папки (`{folder_id}`) по мере перехода на каждый уровень дерева папок:</span><span class="sxs-lookup"><span data-stu-id="1a1be-114">Then, specify the appropriate folder ID (`{folder_id}`) as you navigate each level of the folder tree:</span></span>

```http
GET https://graph.microsoft.com/v1.0/users/{id}/mailFolders/{folder_id}/childfolders
```

<span data-ttu-id="1a1be-115">Повторяйте, пока не достигнете нужной папки в дереве.</span><span class="sxs-lookup"><span data-stu-id="1a1be-115">Repeat until you finally get to the custom folder in the tree.</span></span>

## <a name="creating-and-organizing-the-folder-tree"></a><span data-ttu-id="1a1be-116">Создание и упорядочение дерева папок</span><span class="sxs-lookup"><span data-stu-id="1a1be-116">Creating and organizing the folder tree</span></span>

<span data-ttu-id="1a1be-117">Вы можете [создавать почтовые папки, вложенные в папку "Входящие"](/graph/api/user-post-mailfolders?view=graph-rest-1.0), или [дочерние папки других папок](/graph/api/mailfolder-post-childfolders?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="1a1be-117">You can [create mail folders under the Inbox](/graph/api/user-post-mailfolders?view=graph-rest-1.0), or as [child folders of other folders](/graph/api/mailfolder-post-childfolders?view=graph-rest-1.0).</span></span> <span data-ttu-id="1a1be-118">При создании, [копировании](/graph/api/mailfolder-copy?view=graph-rest-1.0) или [перемещении](/graph/api/mailfolder-move?view=graph-rest-1.0) папки и ее содержимого Outlook обновляет доступные только для чтения свойства **parentFolderId** и **childFolderCount** соответствующих папок.</span><span class="sxs-lookup"><span data-stu-id="1a1be-118">When you create, [copy](/graph/api/mailfolder-copy?view=graph-rest-1.0), or [move](/graph/api/mailfolder-move?view=graph-rest-1.0) a folder and its contents, Outlook updates the read-only **parentFolderId** and **childFolderCount** properties of the involved folders.</span></span> <span data-ttu-id="1a1be-119">Если содержимое папки копируется или перемещается в другую папку, то по умолчанию также меняются идентификаторы отдельных записей содержимого.</span><span class="sxs-lookup"><span data-stu-id="1a1be-119">When the contents of a folder are copied or moved to another folder, by default, the individual entry IDs of the contents also change.</span></span>

<span data-ttu-id="1a1be-120">На уровне содержимого свойства **totalItemCount** и **unreadItemCount** сообщают вам общее количество элементов и число непрочитанных элементов в почтовой папке, соответственно.</span><span class="sxs-lookup"><span data-stu-id="1a1be-120">At the contents level, **totalItemCount** and **unreadItemCount** respectively tell you the number of items and number of unread items in a mail folder.</span></span>
<span data-ttu-id="1a1be-121">На уровне дочерних папок вы можете [получить список дочерних папок](/graph/api/user-list-mailfolders?view=graph-rest-1.0) для папки "Входящие" или другой папки.</span><span class="sxs-lookup"><span data-stu-id="1a1be-121">At the child folders level, you can [list the child folders](/graph/api/user-list-mailfolders?view=graph-rest-1.0) under the Inbox or any other folder.</span></span>
<span data-ttu-id="1a1be-122">Свойство **childFolderCount** представляет количество непосредственных дочерних папок.</span><span class="sxs-lookup"><span data-stu-id="1a1be-122">The **childFolderCount** property represents the number of immediate child folders.</span></span>

<span data-ttu-id="1a1be-123">Помните, что почтовые папки Outlook могут содержать как сообщения, так и другие элементы, например события и контакты.</span><span class="sxs-lookup"><span data-stu-id="1a1be-123">Be aware that Outlook mail folders can contain messages and non-message items such as events and contacts.</span></span> <span data-ttu-id="1a1be-124">В общем случае папки Outlook могут содержать разнородные элементы.</span><span class="sxs-lookup"><span data-stu-id="1a1be-124">In general, Outlook folders can contain heterogeneous items.</span></span>

## <a name="using-rules-to-automate-copying-or-moving-messages"></a><span data-ttu-id="1a1be-125">Использование правил для автоматизации копирования или перемещения сообщений</span><span class="sxs-lookup"><span data-stu-id="1a1be-125">Using rules to automate copying or moving messages</span></span>

<span data-ttu-id="1a1be-126">В Outlook пользователи могут настраивать правила для автоматизации определенных действий с входящими сообщениями при соблюдении некоторых предварительно заданных условий.</span><span class="sxs-lookup"><span data-stu-id="1a1be-126">Outlook lets customers set up rules to automate specific actions on incoming messages when some pre-determined conditions are met.</span></span> <span data-ttu-id="1a1be-127">Вы можете [создать правило](/graph/api/mailfolder-post-messagerules?view=graph-rest-1.0) для папки "Входящие" в виде объекта [messageRule](/graph/api/resources/messagerule?view=graph-rest-1.0), чтобы сообщение копировалось или перемещалось в определенную папку при соблюдении заданных условий.</span><span class="sxs-lookup"><span data-stu-id="1a1be-127">You can [create a rule](/graph/api/mailfolder-post-messagerules?view=graph-rest-1.0) for the Inbox as a [messageRule](/graph/api/resources/messagerule?view=graph-rest-1.0) to copy or move a message to a specific folder upon certain conditions.</span></span>
<span data-ttu-id="1a1be-128">Условия — это объекты [messageRulePredicate](/graph/api/resources/messagerulepredicates?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="1a1be-128">Conditions are [messageRulePredicates](/graph/api/resources/messagerulepredicates?view=graph-rest-1.0).</span></span> <span data-ttu-id="1a1be-129">Они могут включать тему или текст сообщения, определенные электронные адреса отправителей, отметку о важности и т. д.</span><span class="sxs-lookup"><span data-stu-id="1a1be-129">They can include the message subject or body containing certain text,the message sent from certain email addresses, or the message marked important, and so on.</span></span>

## <a name="directing-only-the-messages-you-care-for-to-the-focused-inbox"></a><span data-ttu-id="1a1be-130">Отправка только нужных сообщений на сортировку почты</span><span class="sxs-lookup"><span data-stu-id="1a1be-130">Directing only the messages you care for to the Focused Inbox</span></span>

<span data-ttu-id="1a1be-131">С помощью сортировки почты клиенты могут научить Outlook показывать входящие сообщения от нужных отправителей на вкладке **Отсортированные**, а остальные сообщения — на вкладке **Другие**. Изначально система классификации Outlook упорядочивает сообщения в папке "Входящие" стандартным способом.</span><span class="sxs-lookup"><span data-stu-id="1a1be-131">Focused Inbox lets customers train Outlook to show only the incoming messages from senders you care for in the **Focused** tab, and the rest in the **Other** tab. Initially, Outlook's classification system organizes Inbox messages in a default way.</span></span> <span data-ttu-id="1a1be-132">По мере использования системы вы можете исправлять ее поведение и обучать ее через пользовательский интерфейс или программным путем.</span><span class="sxs-lookup"><span data-stu-id="1a1be-132">Over time, you can correct and train the system through the user interface or programmatically.</span></span> <span data-ttu-id="1a1be-133">Чем больше вы используете сортировку почты, тем лучше система классификации сможет определять, какие входящие сообщения вы хотите видеть на вкладке **Отсортированные**.</span><span class="sxs-lookup"><span data-stu-id="1a1be-133">The more you use the Focused Inbox, the better the classification system can infer which incoming message you want to see in the **Focused** tab.</span></span>

<span data-ttu-id="1a1be-134">Вы можете обновить свойство **inferenceClassification** объекта [message](/graph/api/resources/message?view=graph-rest-1.0) программным путем, чтобы указать, на какой вкладке должно отображаться сообщение: **Отсортированные** или **Другие**. Это свойство назначается отдельно для каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="1a1be-134">Programmatically, you can update the **inferenceClassification** property of a [message](/graph/api/resources/message?view=graph-rest-1.0) to indicate whether you want to see the message in the **Focused** or **Other** tab. This is a one-off designation for a specific message.</span></span> <span data-ttu-id="1a1be-135">С другой стороны, если сообщения от определенного отправителя всегда должны отображаться на вкладке **Отсортированные** или **Другие**, то вы можете [задать инструкцию](/graph/api/inferenceclassification-post-overrides?view=graph-rest-1.0) для Outlook.</span><span class="sxs-lookup"><span data-stu-id="1a1be-135">If, on the other hand, you want to see messages from a specific sender always in the **Focused** tab or **Other** tab, you can [set an instruction](/graph/api/inferenceclassification-post-overrides?view=graph-rest-1.0) for Outlook.</span></span> <span data-ttu-id="1a1be-136">Каждая инструкция представляет собой экземпляр объекта [inferenceClassificationOverride](/graph/api/resources/inferenceclassificationoverride?view=graph-rest-1.0), в котором указаны имя отправителя и вкладка для всех сообщений от этого отправителя: `focused` или `other`.</span><span class="sxs-lookup"><span data-stu-id="1a1be-136">Each instruction is an [inferenceClassificationOverride](/graph/api/resources/inferenceclassificationoverride?view=graph-rest-1.0) instance specifying the sender's name and your designation for messages from that sender to be always `focused` or `other`.</span></span> <span data-ttu-id="1a1be-137">Инструкции каждого пользователя для сортировки почты хранятся в виде коллекции экземпляров [inferenceClassificationOverride](/graph/api/resources/inferenceclassificationoverride?view=graph-rest-1.0) в объекте [user](/graph/api/resources/user?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="1a1be-137">Each user's instructions for the user's Focused Inbox are stored as a collection of [inferenceClassificationOverride](/graph/api/resources/inferenceclassificationoverride?view=graph-rest-1.0) instances on the [user](/graph/api/resources/user?view=graph-rest-1.0) object.</span></span>

## <a name="keeping-messages-and-mail-folders-up-to-date-in-apps"></a><span data-ttu-id="1a1be-138">Обновление сообщений и почтовых папок в приложениях</span><span class="sxs-lookup"><span data-stu-id="1a1be-138">Keeping messages and mail folders up to date in apps</span></span>

<span data-ttu-id="1a1be-139">Многие приложения должны синхронизироваться и обновлять почтовые данные пользователя в его локальном хранилище.</span><span class="sxs-lookup"><span data-stu-id="1a1be-139">Apps often have to synchronize and keep a user's mail data up-to-date in the app local store.</span></span> <span data-ttu-id="1a1be-140">Microsoft Graph позволяет подписаться на уведомления об изменениях данных и запрашивать фактические изменения, как только они происходят.</span><span class="sxs-lookup"><span data-stu-id="1a1be-140">Microsoft Graph lets you subscribe to change notifications to get notified when data changes, and query for actual changes as soon as they happen.</span></span>

<span data-ttu-id="1a1be-141">Уведомления асинхронно доставляются через [веб-перехватчики](/graph/api/resources/webhooks?view=graph-rest-1.0) при внесении изменений, избавляя приложение от необходимости частых опросов.</span><span class="sxs-lookup"><span data-stu-id="1a1be-141">Notifications are delivered via [webhooks](/graph/api/resources/webhooks?view=graph-rest-1.0) asynchronously when the changes happen, saving apps the overhead to poll frequently.</span></span> <span data-ttu-id="1a1be-142">Вы можете [подписаться на уведомления](/graph/api/subscription-post-subscriptions?view=graph-rest-1.0) о добавлении, обновлении или удалении почтовых данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="1a1be-142">You can [subscribe to change notifications](/graph/api/subscription-post-subscriptions?view=graph-rest-1.0) about additions, updates, or deletions to a user's mail data.</span></span> <span data-ttu-id="1a1be-143">Например, вы можете создать подписку на сообщения в определенной папке (т. е. `/me/mailFolders('{folderId'}')`) или на корневом уровне (т. е. `/me/messages`).</span><span class="sxs-lookup"><span data-stu-id="1a1be-143">For example, you can create a subscription to messages in a specific folder (i.e., `/me/mailFolders('{folderId'}')`), or at the root level (i.e., `/me/messages`).</span></span> <span data-ttu-id="1a1be-144">В подписке указывается адрес **notificationUrl**, на который Microsoft Graph отправляет приложению уведомления об изменениях указанных типов.</span><span class="sxs-lookup"><span data-stu-id="1a1be-144">The subscription specifies a **notificationUrl** where Microsoft Graph notifies the app when the requested types of changes happen.</span></span>

<span data-ttu-id="1a1be-145">Для первой синхронизации почтового ящика пользователя сначала отправьте [разностный запрос для почтовых папок, начиная с корневого уровня](/graph/api/mailfolder-delta?view=graph-rest-1.0), чтобы синхронизировать все почтовые папки, а затем — [разностный запрос для сообщений в каждой папке](/graph/api/message-delta?view=graph-rest-1.0), чтобы синхронизировать отдельные сообщения.</span><span class="sxs-lookup"><span data-stu-id="1a1be-145">To initially synchronize a user's mailbox, first do [delta query for mail folders starting at the root level](/graph/api/mailfolder-delta?view=graph-rest-1.0) to synchronize all mail folders, followed by [delta query for messages in each folder](/graph/api/message-delta?view=graph-rest-1.0) to synchronize individual messages.</span></span>

<span data-ttu-id="1a1be-146">Чтобы найти именно те объекты, которые были изменены, не считывая ресурс полностью при каждом уведомлении, вы можете использовать [разностный запрос](delta-query-overview.md) для отслеживания интересующих вас изменений и синхронизировать с ними ваше локальное хранилище.</span><span class="sxs-lookup"><span data-stu-id="1a1be-146">To find the exact entities that have been changed without reading the entire resource with every notification, you can use [delta query](delta-query-overview.md) to track those changes that matter to you, and synchronize your local store with those changes.</span></span> <span data-ttu-id="1a1be-147">Вы можете [отслеживать изменения сообщений в определенной папке](delta-query-messages.md).</span><span class="sxs-lookup"><span data-stu-id="1a1be-147">You can [track changes to messages in a specific folder](delta-query-messages.md).</span></span> <span data-ttu-id="1a1be-148">Вы также можете отслеживать изменения почтовых папок на корневом уровне (т. е. `/me/mailfolders`).</span><span class="sxs-lookup"><span data-stu-id="1a1be-148">You can also track changes to mail folders at the root level (i.e., `/me/mailfolders`).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1a1be-149">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="1a1be-149">Next steps</span></span>

<span data-ttu-id="1a1be-150">Дополнительные сведения:</span><span class="sxs-lookup"><span data-stu-id="1a1be-150">Find out more about:</span></span>

- [<span data-ttu-id="1a1be-151">Зачем выполнять интеграцию с почтой Outlook?</span><span class="sxs-lookup"><span data-stu-id="1a1be-151">Why integrate with Outlook mail</span></span>](outlook-mail-concept-overview.md)
- <span data-ttu-id="1a1be-152">[Использование API почты](/graph/api/resources/mail-api-overview?view=graph-rest-1.0) и [варианты использования](/graph/api/resources/mail-api-overview?view=graph-rest-1.0#common-use-cases) в Microsoft Graph 1.0.</span><span class="sxs-lookup"><span data-stu-id="1a1be-152">[Using the mail API](/graph/api/resources/mail-api-overview?view=graph-rest-1.0) and its [use cases](/graph/api/resources/mail-api-overview?view=graph-rest-1.0#common-use-cases) in Microsoft Graph v1.0.</span></span>
