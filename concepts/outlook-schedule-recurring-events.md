---
title: Планирование повторных встреч, как повторяющихся событий в Outlook
description: Повторяющиеся события — важная составляющая работы с календарями в Outlook. Будь то еженедельная личная встреча с руководителем или обзорное совещание для всего отдела, проходящее во второй вторник каждого месяца, повторяющиеся события достаточно создать один раз, и сервер автоматически продолжит серию.
author: harini84
localization_priority: Priority
ms.prod: outlook
ms.openlocfilehash: dccb42e0e4363eee23bc675154716abde6ffa44dba7abaf64ad7720eceb0e36d
ms.sourcegitcommit: 986c33b848fa22a153f28437738953532b78c051
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "54165562"
---
# <a name="schedule-repeating-appointments-as-recurring-events-in-outlook"></a>Планирование повторных встреч как повторяющихся событий в Outlook

Повторяющиеся события — важная составляющая работы с календарями в Outlook. Будь то еженедельная личная встреча с руководителем или обзорное совещание для всего отдела, проходящее во второй вторник каждого месяца, повторяющиеся события достаточно создать один раз, и сервер автоматически продолжит серию.

Главный элемент, благодаря которому повторяющиеся события превращаются в отдельные экземпляры, — это правило повторения. Правило указывает частоту и продолжительность повторения события. REST API для Outlook моделирует правила повторения в свойстве **recurrence**[ресурса event](/graph/api/resources/event?view=graph-rest-1.0). 

Каждое свойство recurrence состоит из двух частей: расписания повторения (частота) и диапазона повторения (продолжительность).

## <a name="recurrence-patterns"></a>Расписания повторения

Первая часть правила повторения — расписание. Оно задает частоту повторения события. Например, событие может повторяться каждые 3 дня, каждый четверг или каждый год 22 июля. Расписание представлено в API [ресурсом recurrencePattern](/graph/api/resources/recurrencepattern?view=graph-rest-1.0).

В зависимости от того, каков тип расписания, те или иные поля ресурса **recurrencePattern** могут быть обязательными, необязательными или игнорируемыми.

> **Примечание.** Даже если поле игнорируется, оно все равно проверяется. Если для поля задан список возможных значений, то при использовании значения, не входящего в этот список, возникнет ошибка, даже если поле игнорируется.

Рассмотрим все возможные типы расписаний.

### <a name="daily"></a>Ежедневное

При использовании ежедневного расписания повторения событие повторяется в соответствии с указанным количеством дней между экземплярами.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **interval** | Обязательный | Задает количество дней между повторениями. |
| **type** | Обязательный | Необходимо указать значение `daily`. |

#### <a name="examples"></a>Примеры

- Повторять это событие каждый день

  ```json
    "pattern": {
      "type": "daily",
      "interval": 1
    }
  ```
- Повторять это событие каждые три дня

  ```json
    "pattern": {
      "type": "daily",
      "interval": 3
    }
  ```

### <a name="weekly"></a>Еженедельное

При использовании еженедельного расписания повторения событие повторяется в одни и те же дни недели в соответствии с указанным количеством недель между последовательностями экземпляров.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **daysOfWeek** | Обязательный | Указывает, в какие дни недели происходит событие. |
| **firstDayOfWeek** | Необязательный | Указывает, с какого дня начинается неделя. Значение по умолчанию: `Sunday`. |
| **interval** | Обязательный | Задает количество недель между наборами повторений. |
| **type** | Обязательный | Необходимо указать значение `weekly`. |

#### <a name="examples"></a>Примеры

- Повторять это событие каждый четверг

  ```json
    "pattern": {
      "type": "weekly",
      "interval": 1,
      "daysOfWeek": [ "Thursday" ]
    }
  ```
- Повторять это событие каждый понедельник и вторник

  ```json
    "pattern": {
      "type": "weekly",
      "interval": 2,
      "daysOfWeek": [
        "Monday",
        "Tuesday"
      ]
    }
  ```

### <a name="absolute-monthly"></a>Абсолютное ежемесячное

При использовании абсолютного ежемесячного расписания событие повторяется в одно и то же число месяца (например, 15-е) в соответствии с указанным количеством месяцев между повторениями.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **dayOfMonth** | Обязательный | Указывает, в какой день месяца происходит событие. |
| **interval** | Обязательный | Задает количество месяцев между повторениями. |
| **type** | Обязательный | Необходимо указать значение `absoluteMonthly`. |

#### <a name="examples"></a>Примеры

- Повторять это событие 15-го числа каждого месяца

  ```json
    "pattern": {
      "type": "absoluteMonthly",
      "interval": 1,
      "dayOfMonth": 15
    }
  ```
- Повторять это событие ежеквартально (каждые 3 месяца) 7-го числа

  ```json
    "pattern": {
      "type": "absoluteMonthly",
      "interval": 3,
      "dayOfMonth": 7
    }
  ```

### <a name="relative-monthly"></a>Относительное ежемесячное

При использовании относительного ежемесячного расписания повторения событие повторяется в один и тот же день одной и той же (по счету) недели месяца в соответствии с указанным количеством месяцев между повторениями. Пример: "каждую вторую среду месяца".

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **daysOfWeek** | Обязательный | Указывает, в какие дни недели может происходить событие. Относительные ежемесячные события происходят только раз в месяц, поэтому если указать несколько значений, событие будет назначено на первый день, соответствующий расписанию. |
| **index** | Необязательный | Указывает, в какой из разрешенных дней, указанных в **daysOfsWeek**, происходит событие (начиная с первого экземпляра за месяц). Возможные значения: `first`, `second`, `third`, `fourth` и `last`. Значение по умолчанию: `first`. |
| **interval** | Обязательный | Задает количество месяцев между повторениями. |
| **type** | Обязательный | Необходимо указать значение `relativeMonthly`. |

#### <a name="examples"></a>Примеры

- Повторять это событие во вторую среду каждого месяца

  ```json
    "pattern": {
      "type": "relativeMonthly",
      "interval": 1,
      "daysOfWeek": [ "Wednesday" ],
      "index": "second"
    }
  ```
- Повторять это событие в первый четверг или первую пятницу каждого месяца

  ```json
    "pattern": {
      "type": "relativeMonthly",
      "interval": 1,
      "daysOfWeek": [ "Thursday", "Friday" ],
      "index": "first"
    }
  ```

### <a name="absolute-yearly"></a>Абсолютное ежегодное

При использовании абсолютного ежегодного расписания событие повторяется в одни и те же месяц и день года (например, 15 апреля) в соответствии с указанным количеством лет между повторениями.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **dayOfMonth** | Обязательный | Указывает, в какой день месяца происходит событие. |
| **month** | Обязательный | Указывает, в какой месяц происходит событие. |
| **interval** | Обязательный | Задает количество лет между повторениями. |
| **type** | Обязательный | Необходимо указать значение `absoluteYearly`. |

#### <a name="example"></a>Пример

- Повторять это событие 15 апреля каждого года

  ```json
    "pattern": {
      "type": "absoluteYearly",
      "interval": 1,
      "dayOfMonth": 15,
      "month": 4
    }
  ```

### <a name="relative-yearly"></a>Относительное ежегодное

При использовании относительного ежегодного расписания повторения событие повторяется в один и тот же день одной и той же (по счету) недели определенного месяца в соответствии с указанным количеством лет между повторениями. Пример: "каждую последнюю среду ноября".

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **daysOfWeek** | Обязательный | Указывает, в какие дни недели может происходить событие. Относительные ежегодные события происходят только раз в год, поэтому если указать несколько значений, событие будет назначено на первый день, соответствующий расписанию. |
| **index** | Необязательный | Указывает, в какой из разрешенных дней, указанных в **daysOfsWeek**, происходит событие (начиная с первого экземпляра за месяц). Возможные значения: `first`, `second`, `third`, `fourth` и `last`. Значение по умолчанию: `first`. |
| **month** | Обязательный | Указывает, в какой месяц происходит событие. |
| **interval** | Обязательный | Задает количество лет между повторениями. |
| **type** | Обязательный | Необходимо указать значение `relativeYearly`. |

#### <a name="examples"></a>Примеры

- Повторять это событие в последнюю среду ноября каждого года

  ```json
    "pattern": {
      "type": "relativeYearly",
      "interval": 1,
      "daysOfWeek": [ "Wednesday" ],
      "index": "last",
      "month": 11
    }
  ```

## <a name="recurrence-ranges"></a>Диапазоны повторения

Вторая часть правила повторения — диапазон. Он задает продолжительность повторения расписания. Например, событие может быть отменено после 10 повторений, в указанную дату или повторяться бесконечно. Диапазон представлен в API [ресурсом recurrenceRange](/graph/api/resources/recurrencepattern?view=graph-rest-1.0).

В зависимости от того, каков тип диапазона, те или иные поля ресурса **recurrenceRange** могут быть обязательными или игнорируемыми.

> **Примечание.** Даже если поле игнорируется, оно все равно проверяется. Если для поля задан список возможных значений, то при использовании значения, не входящего в этот список, возникнет ошибка, даже если поле игнорируется.

Рассмотрим все возможные типы диапазонов.

### <a name="numbered-range"></a>Нумерованный диапазон

Нумерованный диапазон задает фиксированное количество повторений события (в соответствии с расписанием) с даты начала.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **numberOfOccurences** | Обязательный | Задает количество повторений. Это должно быть положительное целое число. |
| **recurrenceTimeZone** | Необязательный | Задает часовой пояс для свойства **startDate**. Если это свойство не задано, используется часовой пояс события. |
| **startDate** | Обязательный | Задает дату, с которой начинает применяться расписание. Значение свойства **startDate** ДОЛЖНО соответствовать значению даты в свойстве **start**[ресурса event](/graph/api/resources/event?view=graph-rest-1.0). Обратите внимание, что первого собрания может не быть в этот день, если он не соответствует расписанию. |
| **type** | Обязательный | Необходимо указать значение `numbered`. |

#### <a name="examples"></a>Примеры

- Повторять это событие 10 раз

  ```json
    "range": {
      "type": "numbered",
      "startDate": "2017-04-02",
      "numberOfOccurrences": 10
    }
  ```

### <a name="end-date-range"></a>Диапазон с датой окончания

При использовании диапазона с датой окончания событие повторяется во все дни, соответствующие применимому расписанию, между датами начала и окончания.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **endDate** | Обязательный | Задает дату, с которой расписание перестает применяться. Обратите внимание, что последнего собрания может не быть в этот день, если он не соответствует расписанию. |
| **recurrenceTimeZone** | Необязательный | Задает часовой пояс для свойств **startDate** и **endDate**. Если это свойство не задано, используется часовой пояс события. |
| **startDate** | Обязательный | Задает дату, с которой начинает применяться расписание. Значение свойства **startDate** ДОЛЖНО соответствовать значению даты в свойстве **start**[ресурса event](/graph/api/resources/event?view=graph-rest-1.0). Обратите внимание, что первого собрания может не быть в этот день, если он не соответствует расписанию. |
| **type** | Обязательный | Необходимо указать значение **endDate**. |

#### <a name="examples"></a>Примеры

- Повторять это событие с 1 июля 2017 г. до 31 июля 2017 г.

  ```json
    "range": {
      "type": "endDate",
      "startDate": "2017-07-01",
      "endDate": "2017-07-31"
    }
  ```

### <a name="no-end-range"></a>Бесконечный диапазон

При использовании бесконечного диапазона событие происходит во все дни, соответствующие применимому расписанию, после даты начала.

#### <a name="relevant-properties"></a>Соответствующие свойства

| Свойство | Важность | Описание |
|----------|-----------|-------------|
| **recurrenceTimeZone** | Необязательный | Задает часовой пояс для свойства **startDate**. Если это свойство не задано, используется часовой пояс события. |
| **startDate** | Обязательный | Задает дату, с которой начинает применяться расписание. Значение свойства **startDate** ДОЛЖНО соответствовать значению даты в свойстве **start**[ресурса event](/graph/api/resources/event?view=graph-rest-1.0). Обратите внимание, что первого собрания может не быть в этот день, если он не соответствует расписанию. |
| **type** | Обязательный | Необходимо указать значение `noEnd`. |

#### <a name="examples"></a>Примеры

- Бесконечно повторять это событие с 15 мая 2017 г.

  ```json
    "range": {
      "type": "noEnd",
      "startDate": "2017-05-15"
    }
  ```

## <a name="using-patterns-and-ranges-to-create-recurring-events"></a>Создание повторяющихся событий с помощью расписаний и диапазонов

Теперь, когда мы рассмотрели расписания и диапазоны по отдельности, посмотрим на их совместную работу и взаимодействие со свойствами **start** и **end** события.

### <a name="creating-a-recurrence-rule"></a>Создание правила повторения

Чтобы создать правило повторения, необходимо указать и расписание, и диапазон. Расписания всех типов совместимы с диапазонами всех типов. Вот несколько примеров.

#### <a name="examples"></a>Примеры

- **Проведение собраний с 13:00 до 13:30 каждый понедельник, начиная с 4 сентября 2017 г., до конца года**

  - Требование "каждый понедельник" легко соблюдается с помощью расписания повторения типа `weekly`.
  - Требование "до конца года" указывает на диапазон повторения типа `endDate`.

  ```json
    "recurrence": {
      "pattern": {
        "type": "weekly",
        "interval": 1,
        "daysOfWeek": [ "Monday" ]
      },
      "range": {
        "type": "endDate",
        "startDate": "2017-09-04",
        "endDate": "2017-12-31"
      }
    }
  ```

  31 декабря 2017 г. выпадает на воскресенье, поэтому последнее событие в этой серии произойдет в понедельник, 25 декабря.

- **Проведение собраний с 14:00 до 15:00 в первый четверг каждого второго месяца, начиная с 29 августа 2017 г.**

  - Требование "первый четверг каждого второго месяца" можно соблюдать с помощью относительного ежемесячного расписания. Фрагмент "каждого второго месяца" указывает, что для свойства **interval** необходимо задать значение `2`.
  - Дата окончания не указана, поэтому можно использовать диапазон типа `noEnd`.

  ```json
    "recurrence": {
      "pattern": {
        "type": "relativeMonthly",
        "interval": 2,
        "daysOfWeek": [ "Thursday" ],
        "index": "first"
      },
      "range": {
        "type": "noEnd",
        "startDate": "2017-08-29"
      }
    }
  ```

  Значение свойства **startDate** является более поздней датой, чем первый четверг августа, поэтому первое событие в этой серии произойдет в сентябре.

## <a name="next-steps"></a>Дальнейшие действия
    
- Узнайте больше об [интеграции с Календарем Outlook](outlook-calendar-concept-overview.md).
- Другие примеры повторяющихся событий см. в справочнике по API календаря:
  - [Создание события, повторяющегося раз в неделю](/graph/api/user-post-events?view=graph-rest-1.0#request-3)
  - [Создание ежедневно повторяющегося события](/graph/api/user-post-events?view=graph-rest-1.0#request-4)

