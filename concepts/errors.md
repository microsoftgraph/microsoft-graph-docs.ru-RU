---
title: Сообщения об ошибках и типы ресурсов Microsoft Graph
description: В этой статье описаны некоторые ошибки, которые могут возвращаться в ответах Microsoft Graph.
ms.localizationpriority: high
ms.openlocfilehash: 4f080b18e2ef645a2045efe08437bb05684fb2a9
ms.sourcegitcommit: f4999aa6fc05f845027db01aa489f7086f9850e1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2021
ms.locfileid: "60289163"
---
# <a name="microsoft-graph-error-responses-and-resource-types"></a>Сообщения об ошибках и типы ресурсов Microsoft Graph

Сообщения об ошибках в Microsoft Graph возвращаются с использованием стандартных кодов состояния HTTP, а также JSON-объекта сообщения об ошибке.

## <a name="http-status-codes"></a>Коды состояния HTTP

В приведенной ниже таблице представлен список возможных кодов состояния HTTP и их описаний.

| Код состояния | Сообщение о состоянии                  | Описание                                                                                                                            |
|:------------|:--------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------|
| 400         | Неправильный запрос (Bad Request)                     | Не удается обработать запрос, так как он имеет неправильный формат или содержит ошибку.                                                                       |
| 401         | Не авторизован (Unauthorized)                    | Требуемые сведения о проверке подлинности отсутствуют или недопустимы для ресурса.                                                   |
| 403         | Запрещено                       | Доступ к запрошенному ресурсу запрещен. Возможно, у пользователя недостаточно разрешений.<br /><br /> **Важно!** Если к ресурсу применены политики условного доступа, то, возможно, будет возвращена ошибка HTTP 403; Forbidden error=insufficent_claims. Дополнительные сведения о Microsoft Graph и условном доступе см. в статье [Руководство для разработчиков по условному доступу в Azure Active Directory](/azure/active-directory/develop/active-directory-conditional-access-developer)  |
| 404         | Не найдено (Not Found)                       | Запрашиваемый ресурс не существует.                                                                                                  |
| 405         | Недопустимый метод (Method Not Allowed)              | Метод HTTP в запросе недопустим для ресурса.                                                                         |
| 406         | Неприемлемо (Not Acceptable)                  | Эта служба не поддерживает формат, запрошенный в заголовке Accept.                                                                |
| 409         | Конфликт (Conflict)                        | Текущее состояние противоречит ожидаемым результатам запроса. Например, может отсутствовать указанная родительская папка.                   |
| 410         | Отсутствует (Gone)                            | Запрошенный ресурс недоступен на сервере.                                               |
| 411         | Требуется длина (Length Required)                 | В запросе нужно указать заголовок Content-Length.                                                                                    |
| 412         | Необходимое условие не выполнено (Precondition Failed)             | Необходимое условие, указанное в запросе (например, заголовок If-Match), не соответствует текущему состоянию ресурса.                       |
| 413         | Слишком большой объект запроса (Request Entity Too Large)        | Размер запроса превышает максимальное значение.                                                                                            |
| 415         | Неподдерживаемый тип носителя (Unsupported Media Type)          | Тип содержимого запроса имеет формат, который не поддерживает служба.                                                      |
| 416         | Запрошенный диапазон невыполним (Requested Range Not Satisfiable) | Указан недопустимый или недоступный диапазон байтов.                                                                                    |
| 422         | Необрабатываемый объект (Unprocessable Entity)            | Не удается обработать запрос из-за неправильной семантики.                                                                        |
| 423         | Заблокирован                          | Ресурс заблокирован.                                                                                          |
| 429         | Слишком много запросов (Too Many Requests)               | Количество запросов клиентского приложения отрегулировано, оно сможет повторить запрос по истечении некоторого времени.                |
| 500         | Внутренняя ошибка сервера (Internal Server Error)           | При обработке запроса возникла внутренняя ошибка сервера.                                                                       |
| 501         | Не реализовано (Not Implemented)                 | Запрашиваемая функция не реализована.                                                                                               |
| 503         | Служба недоступна (Service Unavailable)             | Служба недоступна из-за перегрузки или отключена для проведения технических работ. Вы можете повторить запрос через некоторое время, которое может быть указано в заголовке Retry-After.|
| 504         | Истекло время ожидания шлюза (Gateway Timeout)                 | При попытке выполнить запрос, сервер, выполняя роль прокси-сервера, не получил своевременный ответ от сервера более высокого уровня, необходимый для доступа. Может возникать вместе с ошибкой 503. |
| 507         | Недостаточно места (Insufficient Storage)            | Достигнута максимальная квота хранилища.                                                                                            |
| 509         | Превышено ограничение пропускной способности (Bandwidth Limit Exceeded)        | Пропускная способность приложения отрегулирована из-за превышения максимально допустимой пропускной способности. Приложение сможет повторить запрос по истечении некоторого времени. |

Сообщение об ошибке — это один объект JSON, содержащий одно свойство **error**. Этот объект включает все сведения об ошибке. Вы можете использовать возвращенные сведения вместо кода состояния HTTP или вместе с ним. Ниже представлен пример полного текста ошибки JSON.

<!-- { "blockType": "ignored", "@odata.type": "odata.error", "expectError": true, "name": "example-error-response" } -->
```json
{
  "error": {
    "code": "invalidRange",
    "message": "Uploaded fragment overlaps with existing data.",
    "innerError": {
      "requestId": "request-id",
      "date": "date-time"
    }
  }
}
```

<!--<a name="msg_error_resource_type"> </a> -->

## <a name="error-resource-type"></a>Тип ресурса ошибки

Ресурс ошибки возвращается, если при обработке запроса происходит ошибка.

Сообщения об ошибках соответствуют определению в спецификации [OData версии 4](https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793091).

### <a name="json-representation"></a>Представление JSON

Ресурс ошибки состоит из указанных ниже ресурсов.

<!-- { "blockType": "resource", "@odata.type": "odata.error" } -->
```json
{
  "error": { "@odata.type": "odata.error" }  
}
```

#### <a name="odataerror-resource-type"></a>Тип ресурса odata.error

Сообщение об ошибке содержит ресурс ошибки, состоящий из следующих свойств:

<!-- { "blockType": "resource", "@odata.type": "odata.error", "optionalProperties": [ "target", "details", "innererror"] } -->
```json
{
  "code": "string",
  "message": "string",
  "innererror": { "@odata.type": "odata.error" }
}
```

| Имя свойства  | Значение                  | Описание                                                                                                |
|:---------------|:-----------------------|:-----------------------------------------------------------------------------------------------------------|
| **code**       | string                 | Строка с кодом возникшей ошибки                                                            |
| **message**    | string                 | Сообщение для разработчика о возникшей ошибке. Оно не предназначено для пользователя. |
| **innererror** | error object           | Необязательное. Дополнительные объекты ошибки, которые могут быть более информативны, чем сообщение об ошибке верхнего уровня.                     |

<!--<a name="msg_code_property"> </a> -->

#### <a name="code-property"></a>Свойство code

Свойство `code` содержит одно из перечисленных ниже значений. Приложения должны быть готовы к любой из этих ошибок.

| Код                      | Описание
|:--------------------------|:--------------
| **accessDenied**          | У вызывающей стороны нет разрешения на выполнение действия. 
| **activityLimitReached**  | Действия приложения или пользователя превысили ограничения.
| **extensionError**        | Почтовый ящик расположен в локальной системе, а сервер Exchange Server не поддерживает федеративные запросы Microsoft Graph или [ политика приложений](./auth-limit-mailbox-access.md) не позволяет приложению получить доступ к почтовому ящику.
| **generalException**      | Произошла неуказанная ошибка.
| **invalidRange**          | Указан недопустимый или недоступный диапазон байтов.
| **invalidRequest**        | Запрос имеет неправильный формат или содержит ошибку.
| **itemNotFound**          | Не удалось найти ресурс.
| **malwareDetected**       | В запрошенном ресурсе обнаружена вредоносная программа.
| **nameAlreadyExists**     | Элемент с указанным именем уже существует.
| **notAllowed**            | Действие запрещено системой.
| **notSupported**          | Запрос не поддерживается в системе.
| **resourceModified**      | Обновляемый ресурс изменился с момента последнего чтения вызывающей стороной. Как правило, не совпадают теги eTag.
| **resyncRequired**        | Разностный токен больше не действителен, а приложение должно сбросить состояние синхронизации.
| **serviceNotAvailable**   | Служба недоступна. Повторите запрос через некоторое время. Возможно, существует заголовок Retry-After. 
| **syncStateNotFound**     | Создание состояния синхронизации не найдено. Срок действия разностного маркера истек, и данные требуется синхронизировать повторно. 
| **quotaLimitReached**     | Пользователь превысил квоту.
| **unauthenticated**       | Вызывающая сторона не прошла проверку подлинности.

Объект `innererror` может рекурсивно содержать дополнительные объекты `innererror` с другими, более подробными кодами ошибок. При обработке ошибок приложения должны перебирать все доступные коды ошибок и использовать самый подробный и понятный. В конце этой страницы приведено несколько более подробных кодов.

Чтобы убедиться, что объект ошибки представляет собой ожидаемую ошибку, необходимо перебрать объекты `innererror` и найти ожидаемые коды ошибок. Например:

```csharp
public bool IsError(string expectedErrorCode)
{
    OneDriveInnerError errorCode = this.Error;
    while (null != errorCode)
    {
        if (errorCode.Code == expectedErrorCode)
            return true;
        errorCode = errorCode.InnerError;
    }
    return false;
}
```

В примере [Обработка кодов ошибок](https://gist.github.com/rgregg/a1866be15e685983b441) показано, как правильно обрабатывать ошибки.

Свойство `message` в корне содержит сообщение об ошибке, предназначенное для разработчика. Сообщения об ошибках не локализованы и не предназначены для пользователя. Приложение не должно обрабатывать значения `message`, так как они могут измениться в любое время и часто содержат динамические сведения, связанные с неудачным запросом. Приложение должно обрабатывать только те коды ошибок, которые возвращаются в свойствах `code`.

#### <a name="detailed-error-codes"></a>Подробные коды ошибок
Ниже приведено несколько дополнительных ошибок, которые могут возникать при работе приложения во вложенных объектах `innererror`. Приложения не обязаны их обрабатывать. Служба в любое время может добавить новые коды ошибок или прекратить возврат старых кодов, поэтому важно, чтобы все приложения могли обрабатывать [основные коды ошибок](#code-property).

| Код                               | Описание
|:-----------------------------------|:----------------------------------------------------------
| **accessRestricted**               | Доступ разрешен только владельцу элемента.
| **cannotSnapshotTree**             | Не удалось получить согласованный разностный моментальный снимок. Повторите попытку позже.
| **childItemCountExceeded**         | Достигнуто максимальное количество дочерних элементов.
| **entityTagDoesNotMatch**          | Тег ETag не соответствует текущему значению элемента.
| **fragmentLengthMismatch**         | Объявленный общий размер этого фрагмента отличается от размера сеанса отправки.
| **fragmentOutOfOrder**             | Фрагмент передан не по порядку.
| **fragmentOverlap**                | Переданный фрагмент перекрывает существующие данные.
| **invalidAcceptType**              | Недопустимый тип входных данных.
| **invalidParameterFormat**         | Недопустимый формат параметра.
| **invalidPath**                    | Имя содержит недопустимые символы.
| **invalidQueryOption**             | Недопустимый параметр запроса.
| **invalidStartIndex**              | Недопустимый начальный индекс.
| **lockMismatch**                   | Маркер блокировки не соответствует существующей блокировке.
| **lockNotFoundOrAlreadyExpired**   | В данный момент для элемента не задана действительная блокировка.
| **lockOwnerMismatch**              | Идентификатор владельца блокировки не соответствует указанному идентификатору.
| **malformedEntityTag**             | Неправильный формат заголовка тега ETag. Теги ETag должны представлять собой строки, заключенные в кавычки.
| **maxDocumentCountExceeded**       | Достигнуто максимальное количество документов.
| **maxFileSizeExceeded**            | Превышен максимальный размер файла.
| **maxFolderCountExceeded**         | Достигнуто максимальное количество папок.
| **maxFragmentLengthExceeded**      | Превышен максимальный размер файла.
| **maxItemCountExceeded**           | Достигнуто максимальное количество элементов.
| **maxQueryLengthExceeded**         | Превышена максимальная длина запроса.
| **maxStreamSizeExceeded**          | Превышен максимальный размер потока.
| **parameterIsTooLong**             | Превышена максимальная длина параметра.
| **parameterIsTooSmall**            | Размер параметра меньше минимального значения.
| **pathIsTooLong**                  | Превышена максимальная длина пути.
| **pathTooDeep**                    | Достигнуто максимальное число уровней в иерархии папок.
| **propertyNotUpdateable**          | Свойство не поддерживает обновление.
| **provisioningNotAllowed**         | Для запроса требуется подготовка учетной записи, которая запрещена.
| **resourceBeingProvisioned**       | Выполняется подготовка запрошенного ресурса.
| **resyncApplyDifferences**         | Требуется повторная синхронизация. Замените все локальные элементы элементами сервера (в том числе удаленные), если вы уверены, что в службу были внесены все локальные изменения при последней синхронизации. Отправьте все локальные изменения, не загруженные на сервер.
| **resyncRequired**                 | Требуется повторная синхронизация.
| **resyncUploadDifferences**        | Требуется повторная синхронизация. Отправьте все локальные элементы, которые не возвратила служба, и все файлы, версия которых отличается от версии сервера (сохраняйте обе копии, если вы не знаете, какая из них более актуальна).
| **serviceNotAvailable**            | Сервер не может обработать текущий запрос.
| **serviceReadOnly**                | Ресурс временно доступен только для чтения.
| **throttledRequest**               | Слишком много запросов.
| **tooManyResultsRequested**        | Запрошено слишком много результатов.
| **tooManyTermsInQuery**            | Запрос содержит слишком много условий.
| **totalAffectedItemCountExceeded** | Операция запрещена, так как количество задействованных элементов превышает пороговое значение.
| **truncationNotAllowed**           | Усечение данных запрещено.
| **uploadSessionFailed**            | Ошибка сеанса отправки.
| **uploadSessionIncomplete**        | Сеанс отправки не завершен.
| **uploadSessionNotFound**          | Сеанс отправки не найден.
| **virusSuspicious**                | Этот документ подозрительный и может содержать вирус.
| **zeroOrFewerResultsRequested**    | Запрошено ноль или меньше результатов.


<!-- {
  "type": "#page.annotation",
  "description": "Understand the error format for the API and error codes.",
  "keywords": "error response, error, error codes, innererror, message, code",
  "section": "documentation",
  "suppressions": [
    " Warning: /concepts/errors.md:
      Multiple resources found in file, but we only support one per file. 'odata.error,odata.error'. Skipping."
  ],
  "tocPath": "Misc/Error Responses"
} -->
