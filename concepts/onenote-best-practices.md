---
title: Рекомендации по работе с API OneNote
description: Ознакомьтесь с рекомендациями по работе с API OneNote в Microsoft Graph на основе ответов на часто задаваемые вопросы о Microsoft Q&A и Twitter.
author: jewan-microsoft
ms.localizationpriority: medium
ms.prod: onenote
ms.openlocfilehash: 8d67f5ca0a6f21fc9fb4fab01534634f52e15cef
ms.sourcegitcommit: b2b3c3ae00f9e2e0bb2dcff30e97b60ccdebf170
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2022
ms.locfileid: "66442838"
---
# <a name="best-practices-for-working-with-the-onenote-api-in-microsoft-graph"></a>Рекомендации по работе с API OneNote в Microsoft Graph

В этой статье содержатся рекомендации по работе с API OneNote в Microsoft Graph. Эти рекомендации основаны на ответах на часто задаваемые вопросы в [Microsoft Q&A](/answers/topics/microsoft-graph-notes.html)  и Twitter.

## <a name="use-select-to-select-the-minimum-set-of-properties-you-need"></a>Используйте оператор $select, чтобы выбрать минимальный набор необходимых свойств

Если вам необходимо отправить запрос к ресурсу (например, к разделам в записной книжке), создайте запрос, аналогичный указанному ниже.

```http
GET ~/notebooks/{id}/sections
```

С его помощью можно получить все свойства разделов. Возможно, вам нужны не все свойства. Вы можете использовать параметр запроса `$select`, чтобы возвращать только необходимые вам свойства, как показано в примере ниже.

```http
GET ~/notebooks/{id}/sections?$select=id,displayName
```

Такой же подход применяется к другим API OneNote.

## <a name="use-expand-instead-of-making-multiple-api-calls"></a>Вместо нескольких запросов к API используйте оператор $expand

Предположим, вы хотите получить все записные книжки, разделы и группы разделов пользователя в виде иерархического представления. Это можно сделать следующим образом:

* Совершите вызов `GET ~/notebooks`, чтобы получить список записных книжек.

* Для каждой полученной записной книжки совершите вызов `GET ~/notebooks/{notebookId}/sections`, чтобы получить список разделов в ней.

* Для каждой полученной записной книжки совершите вызов `GET ~/notebooks/{notebookId}/sectionGroups`, чтобы получить список групп разделов в ней.

* При необходимости выполните рекурсивные итерации в группах разделов.

Несмотря на то что это будет работать (с несколькими дополнительными последовательными циклическими обращениями к службе), лучше использовать параметр запроса `$expand`. 

```http
GET ~/notebooks?$expand=sections,sectionGroups($expand=sections)
```

Он даст те же результаты за одно циклическое обращение по сети, но с более высокой производительностью.

## <a name="when-getting-all-pages-for-a-user-do-so-for-each-section-separately"></a>При получении всех страниц для пользователя выполните эти действия отдельно для каждого раздела

Несмотря на то что Microsoft Graph предоставляет конечную точку для получения всех страниц, это не лучший способ получить все страницы, к которым у пользователя есть доступ. Если у пользователя слишком много разделов, это может привести к задержкам или снижению производительности. Лучше выполнять итерации для каждого раздела, получая страницы отдельно для каждого раздела.

Например, вместо использования этого вызова (это постраничный API, поэтому вам не удастся получить все страницы за один раз):

```http
GET ~/pages
```

Лучше несколько раз использовать следующий вызов (особенно если вам не нужны все разделы):

```http
GET ~/sections/{id}/pages
```

При получении метаданных страницы переопределите способ упорядочивания `lastModifiedDateTime`, используемый по умолчанию. Страницы можно получить быстрее, если не нужно сортировать их по `lastModifiedDateTime`. Для этого вы можете выполнить сортировку по любому другому свойству. Пример:

```http
GET ~/sections/{id}/pages?$select=id,title,createdDateTime&$orderby=createdDateTime
```
