---
title: Различия функций между Azure AD Graph и Microsoft Graph
description: Описывает различия между API Azure Active Directory (Azure AD) и API Microsoft Graph, чтобы помочь быстро и легко перенести приложения.
author: dkershaw10
localization_priority: Normal
ms.prod: applications
ms.openlocfilehash: a404c69370c7b6aaeee07e20df1165c43a98a243
ms.sourcegitcommit: 9d98d9e9cc1e193850ab9b82aaaf906d70e1378b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2021
ms.locfileid: "50760681"
---
# <a name="feature-differences-between-azure-ad-graph-and-microsoft-graph"></a>Различия функций между Azure AD Graph и Microsoft Graph

Эта статья является *частью шага 1: просмотрите различия API* процесса переноса [приложений.](migrate-azure-ad-graph-planning-checklist.md)

Многие функции в Microsoft Graph работают так же, как и их коллеги Azure AD Graph. Однако некоторые из них были изменены и/или улучшены. Здесь вы узнаете, как адаптировать приложения, чтобы воспользоваться этими различиями.  Часто изменения незначительны, но стоит усилий.

В этой статье исследуется, как microsoft Graph обрабатывает:

- Расширения схемы каталога
- Дифференциальные запросы
- Пакетная обработка

## <a name="directory-schema-extensions"></a>Расширения схемы каталога

Если ваше приложение использует расширения каталога Azure AD Graph, вы можете продолжать использовать те же основные API (с URL-адресами запросов Microsoft Graph), чтобы:

- Управление определениями свойств расширения с помощью свойства **extensionProperties** на ресурсе [application][/graph/api/resources/application?view=graph-rest-v1.0).
- Получите доступные свойства расширения с помощью [действия getAvailableExtensionProperties.](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0)
- Чтение значений расширения с помощью GET и `$select`
- Поиск по значениям расширения с помощью GET и `$filter`
- Обновление значений расширения с помощью PATCH
- Удаление значений расширения с помощью PATCH (значение **null)**

Microsoft Graph предоставляет расширенный опыт разработки расширений схемы, который сегодня не совместим с расширениями каталогов Azure AD Graph. Дополнительные сведения см. в дополнительных сведениях о расширении [схемы в добавлении настраиваемой информации.](./extensibility-overview.md#schema-extensions)

### <a name="recommended-migration-approach"></a>Рекомендуемый подход к миграции

Если в приложении Azure AD Graph используются расширения каталогов, применяйте дополнительный подход для переноса приложения в Microsoft Graph.

Сначала переключите приложение на использование вызовов API Microsoft Graph, но позвольте приложению продолжать использовать расширения каталогов Azure AD Graph.

Затем можно перейти на использование расширений схемы Microsoft Graph. В некоторых случаях переключение не подходит. Не переключаться, если:

- Ваше приложение использует расширения каталогов, созданные через AD Connect
- Приложение задает значения расширения каталогов, которые используются в утверждениях маркеров другими приложениями
- Приложение задает значения расширения каталогов, которые используются в динамических правилах членства 

>**ПРИМЕЧАНИЕ.** Использование свойств расширения схемы Microsoft Graph в качестве утверждений в маркере с использованием необязательных утверждений или динамического правила членства еще не поддерживается.

Чтобы перейти на более новую модель расширения схемы Microsoft Graph, необходимо:

- Определение новых определений расширения схемы с помощью Microsoft Graph.
- Обновление приложения для поддержки новых определений расширения схемы.
- Перенос данных из свойств расширения схемы Azure AD в новые свойства расширения схемы Microsoft Graph.  Автоматическая миграция данных не поддерживается.

## <a name="differential-queries"></a>Дифференциальные запросы

Azure AD Graph и Microsoft Graph позволит отслеживать изменения с помощью запросов.  Подход на высоком уровне аналогиен двум API, но синтаксис отличается.

Azure AD Graph вызывает эти дифференциальные запросы.  В Microsoft Graph это [дельта-запросы.](./delta-query-overview.md)

В следующей таблице выделяются ключевые сходства и различия:

|Запрос Delta |Azure AD Graph | Microsoft Graph |
|----|----|----|
| _Начальный запрос данных_ | Использует параметр запроса:<br>`GET /groups?deltaLink=` | Использует функцию: <br> `GET /groups/delta` |
| _Новые изменения_ | `GET /groups?deltaLink={deltaToken}` | `GET /groups/delta?$deltaToken={deltaToken}` |
| _Синхронизация с этого времени_ |Использует настраиваемый http-загот:<br> `ocp-aad-dq-include-only-delta-token: true` | Использует параметр запроса: <br> `GET /groups/delta?$deltaToken=latest` |
| _Отслеживание изменений для directoryObjects_ | Получает изменения для нескольких ресурсов (пользователя и группы) в одной операции:&nbsp;&nbsp;<br> `GET /directoryObject?$filter=isof('User') or isof('Group')&deltaLink=` | Использует отдельные запросы с Помощью Microsoft Graph, по одному для каждого ресурса. |
| _Изменение ресурсов и отношений_ | Все запросы возвращают изменения ресурсов и отношений, если у ресурса есть связи. | `GET /groups/delta?$expand=members` |
| _Ответ, указывающий на новые и измененные элементы_ | <ul><li><p>Представляет вновь созданные экземпляры с использованием стандартного представления.</p></li><li><p>Обновленные экземпляры представлены их id  с по крайней мере обновленными свойствами. Другие свойства могут быть включены.</p></li><li><p>В качестве типа представлены `directoryLinkChange` отношения.</p></li></ul>|<ul><li><p>Представляет вновь созданные экземпляры с использованием стандартного представления.</p></li><li><p>Обновленные экземпляры представлены их id  с по крайней мере обновленными свойствами. Другие свойства могут быть включены.</p></li><li><p>Отношения представлены в качестве аннотации в стандартном представлении ресурсов. В этих аннотациях используется формат, например для изменения `propertyName@delta` `members@delta` членства группы.</p></li></ul> |
| _Ответ с указанием удаленных элементов_| Указывает удаленный элемент с дополнительным свойством *aad.isDeleted* set to true. | Указывает удаленный элемент с \@ удаленной аннотацией. Он также может содержать код причины, который указывает, удален ли элемент, но может быть восстановлен или удален навсегда. |

Если в вашем приложении уже хранятся данные о состоянии, рассмотрите возможность использования показанной ранее "синхронизации" для управления переходом на запросы delta.

## <a name="batching"></a>Пакетная обработка

Azure AD Graph использовал систему, называемую многосерийными сообщениями MIME, для управления пакетами.  Microsoft Graph использует [пакеты JSON](json-batching.md) для разрешения до 20 запросов в одной пакетной операции. Механизм пакетной обработки JSON значительно проще в использовании, особенно вместе с библиотеками размыкания JSON.  Кроме того, он позволяет последовательно секвенация пакетных операций.  Однако он не совместим с пакетным подходом Azure AD Graph.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте о [различиях ресурсов](migrate-azure-ad-graph-resource-differences.md) между Azure AD Graph и Microsoft Graph.
- Снова [просмотрите контрольный](migrate-azure-ad-graph-planning-checklist.md) список.

<!-- {
  "type": "#page.annotation",
  "suppressions": [
    "Warning: /concepts/migrate-azure-ad-graph-feature-changes.md:
      Failed to parse any rows out of table with headers: |Task|Azure AD Graph|Microsoft Graph|"
  ],
}
-->