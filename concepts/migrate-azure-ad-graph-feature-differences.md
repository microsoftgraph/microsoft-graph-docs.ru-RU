---
title: Различия функций между Azure AD Graph и Microsoft Graph
description: Описывает различия между API Azure Active Directory (Azure AD) и API Microsoft Graph, чтобы помочь быстро и легко перенести приложения.
author: dkershaw10
localization_priority: Normal
ms.prod: applications
ms.openlocfilehash: a404c69370c7b6aaeee07e20df1165c43a98a243
ms.sourcegitcommit: 9d98d9e9cc1e193850ab9b82aaaf906d70e1378b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2021
ms.locfileid: "50760681"
---
# <a name="feature-differences-between-azure-ad-graph-and-microsoft-graph"></a><span data-ttu-id="98b81-103">Различия функций между Azure AD Graph и Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="98b81-103">Feature differences between Azure AD Graph and Microsoft Graph</span></span>

<span data-ttu-id="98b81-104">Эта статья является *частью шага 1: просмотрите различия API* процесса переноса [приложений.](migrate-azure-ad-graph-planning-checklist.md)</span><span class="sxs-lookup"><span data-stu-id="98b81-104">This article is part of *step 1: review API differences* of the [process to migrate apps](migrate-azure-ad-graph-planning-checklist.md).</span></span>

<span data-ttu-id="98b81-105">Многие функции в Microsoft Graph работают так же, как и их коллеги Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-105">Many features in Microsoft Graph work similarly to their Azure AD Graph counterparts.</span></span> <span data-ttu-id="98b81-106">Однако некоторые из них были изменены и/или улучшены.</span><span class="sxs-lookup"><span data-stu-id="98b81-106">However, a few have been changed and/or improved.</span></span> <span data-ttu-id="98b81-107">Здесь вы узнаете, как адаптировать приложения, чтобы воспользоваться этими различиями.</span><span class="sxs-lookup"><span data-stu-id="98b81-107">Here, you'll learn how to adapt your apps to take advantage of these differences.</span></span>  <span data-ttu-id="98b81-108">Часто изменения незначительны, но стоит усилий.</span><span class="sxs-lookup"><span data-stu-id="98b81-108">Frequently, the changes are minor, but well worth the effort.</span></span>

<span data-ttu-id="98b81-109">В этой статье исследуется, как microsoft Graph обрабатывает:</span><span class="sxs-lookup"><span data-stu-id="98b81-109">This article explores how Microsoft Graph handles:</span></span>

- <span data-ttu-id="98b81-110">Расширения схемы каталога</span><span class="sxs-lookup"><span data-stu-id="98b81-110">Directory schema extensions</span></span>
- <span data-ttu-id="98b81-111">Дифференциальные запросы</span><span class="sxs-lookup"><span data-stu-id="98b81-111">Differential queries</span></span>
- <span data-ttu-id="98b81-112">Пакетная обработка</span><span class="sxs-lookup"><span data-stu-id="98b81-112">Batching</span></span>

## <a name="directory-schema-extensions"></a><span data-ttu-id="98b81-113">Расширения схемы каталога</span><span class="sxs-lookup"><span data-stu-id="98b81-113">Directory schema extensions</span></span>

<span data-ttu-id="98b81-114">Если ваше приложение использует расширения каталога Azure AD Graph, вы можете продолжать использовать те же основные API (с URL-адресами запросов Microsoft Graph), чтобы:</span><span class="sxs-lookup"><span data-stu-id="98b81-114">If your app uses Azure AD Graph directory extensions, you can continue to use the same basic APIs (with Microsoft Graph request URLs) to:</span></span>

- <span data-ttu-id="98b81-115">Управление определениями свойств расширения с помощью свойства **extensionProperties** на ресурсе [application][/graph/api/resources/application?view=graph-rest-v1.0).</span><span class="sxs-lookup"><span data-stu-id="98b81-115">Manage extension property definitions using the **extensionProperties** property on the [application][/graph/api/resources/application?view=graph-rest-v1.0) resource.</span></span>
- <span data-ttu-id="98b81-116">Получите доступные свойства расширения с помощью [действия getAvailableExtensionProperties.](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0)</span><span class="sxs-lookup"><span data-stu-id="98b81-116">Get available extension properties using the [getAvailableExtensionProperties](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0) action.</span></span>
- <span data-ttu-id="98b81-117">Чтение значений расширения с помощью GET и `$select`</span><span class="sxs-lookup"><span data-stu-id="98b81-117">Read extension values using GET and `$select`</span></span>
- <span data-ttu-id="98b81-118">Поиск по значениям расширения с помощью GET и `$filter`</span><span class="sxs-lookup"><span data-stu-id="98b81-118">Search on extension values using GET and `$filter`</span></span>
- <span data-ttu-id="98b81-119">Обновление значений расширения с помощью PATCH</span><span class="sxs-lookup"><span data-stu-id="98b81-119">Update extension values using PATCH</span></span>
- <span data-ttu-id="98b81-120">Удаление значений расширения с помощью PATCH (значение **null)**</span><span class="sxs-lookup"><span data-stu-id="98b81-120">Remove extension values using PATCH (set to **null**)</span></span>

<span data-ttu-id="98b81-121">Microsoft Graph предоставляет расширенный опыт разработки расширений схемы, который сегодня не совместим с расширениями каталогов Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-121">Microsoft Graph provides an enhanced schema extensions developer experience, which today is not backwards compatible with Azure AD Graph directory extensions.</span></span> <span data-ttu-id="98b81-122">Дополнительные сведения см. в дополнительных сведениях о расширении [схемы в добавлении настраиваемой информации.](./extensibility-overview.md#schema-extensions)</span><span class="sxs-lookup"><span data-stu-id="98b81-122">To learn more, see [schema extensions in add custom data](./extensibility-overview.md#schema-extensions).</span></span>

### <a name="recommended-migration-approach"></a><span data-ttu-id="98b81-123">Рекомендуемый подход к миграции</span><span class="sxs-lookup"><span data-stu-id="98b81-123">Recommended migration approach</span></span>

<span data-ttu-id="98b81-124">Если в приложении Azure AD Graph используются расширения каталогов, применяйте дополнительный подход для переноса приложения в Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-124">If your Azure AD Graph app uses directory extensions, take an incremental approach to migrate the app to Microsoft Graph.</span></span>

<span data-ttu-id="98b81-125">Сначала переключите приложение на использование вызовов API Microsoft Graph, но позвольте приложению продолжать использовать расширения каталогов Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-125">First, switch your app to using Microsoft Graph API calls, but let the app continue to leverage Azure AD Graph directory extensions.</span></span>

<span data-ttu-id="98b81-126">Затем можно перейти на использование расширений схемы Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-126">Then, you can switch to using Microsoft Graph schema extensions.</span></span> <span data-ttu-id="98b81-127">В некоторых случаях переключение не подходит.</span><span class="sxs-lookup"><span data-stu-id="98b81-127">In some cases, switching will not be appropriate.</span></span> <span data-ttu-id="98b81-128">Не переключаться, если:</span><span class="sxs-lookup"><span data-stu-id="98b81-128">Do not switch if:</span></span>

- <span data-ttu-id="98b81-129">Ваше приложение использует расширения каталогов, созданные через AD Connect</span><span class="sxs-lookup"><span data-stu-id="98b81-129">Your app uses directory extensions created through AD Connect</span></span>
- <span data-ttu-id="98b81-130">Приложение задает значения расширения каталогов, которые используются в утверждениях маркеров другими приложениями</span><span class="sxs-lookup"><span data-stu-id="98b81-130">Your app sets directory extension values that are used in token claims by other apps</span></span>
- <span data-ttu-id="98b81-131">Приложение задает значения расширения каталогов, которые используются в динамических правилах членства</span><span class="sxs-lookup"><span data-stu-id="98b81-131">Your app sets directory extension values that are used in dynamic membership rules</span></span> 

><span data-ttu-id="98b81-132">**ПРИМЕЧАНИЕ.** Использование свойств расширения схемы Microsoft Graph в качестве утверждений в маркере с использованием необязательных утверждений или динамического правила членства еще не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="98b81-132">**NOTE**: Using Microsoft Graph schema extension properties as claims in a token using optional claims or in a dynamic membership rule is not yet supported.</span></span>

<span data-ttu-id="98b81-133">Чтобы перейти на более новую модель расширения схемы Microsoft Graph, необходимо:</span><span class="sxs-lookup"><span data-stu-id="98b81-133">To switch to the newer Microsoft Graph schema extension model, you'll need to:</span></span>

- <span data-ttu-id="98b81-134">Определение новых определений расширения схемы с помощью Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-134">Define new schema extension definitions using Microsoft Graph.</span></span>
- <span data-ttu-id="98b81-135">Обновление приложения для поддержки новых определений расширения схемы.</span><span class="sxs-lookup"><span data-stu-id="98b81-135">Update the app to support the new schema extension definitions.</span></span>
- <span data-ttu-id="98b81-136">Перенос данных из свойств расширения схемы Azure AD в новые свойства расширения схемы Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-136">Migrate the data from the Azure AD schema extension properties to the new Microsoft Graph schema extension properties.</span></span>  <span data-ttu-id="98b81-137">Автоматическая миграция данных не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="98b81-137">Automatic migration of data is not supported.</span></span>

## <a name="differential-queries"></a><span data-ttu-id="98b81-138">Дифференциальные запросы</span><span class="sxs-lookup"><span data-stu-id="98b81-138">Differential queries</span></span>

<span data-ttu-id="98b81-139">Azure AD Graph и Microsoft Graph позволит отслеживать изменения с помощью запросов.</span><span class="sxs-lookup"><span data-stu-id="98b81-139">Azure AD Graph and Microsoft Graph let you track changes using queries.</span></span>  <span data-ttu-id="98b81-140">Подход на высоком уровне аналогиен двум API, но синтаксис отличается.</span><span class="sxs-lookup"><span data-stu-id="98b81-140">The high-level approach is similar between the two APIs, but the syntax is different.</span></span>

<span data-ttu-id="98b81-141">Azure AD Graph вызывает эти дифференциальные запросы.</span><span class="sxs-lookup"><span data-stu-id="98b81-141">Azure AD Graph calls these differential queries.</span></span>  <span data-ttu-id="98b81-142">В Microsoft Graph это [дельта-запросы.](./delta-query-overview.md)</span><span class="sxs-lookup"><span data-stu-id="98b81-142">In Microsoft Graph, they're [delta queries](./delta-query-overview.md).</span></span>

<span data-ttu-id="98b81-143">В следующей таблице выделяются ключевые сходства и различия:</span><span class="sxs-lookup"><span data-stu-id="98b81-143">The following table highlights key similarities and differences:</span></span>

|<span data-ttu-id="98b81-144">Запрос Delta</span><span class="sxs-lookup"><span data-stu-id="98b81-144">Delta request</span></span> |<span data-ttu-id="98b81-145">Azure AD Graph</span><span class="sxs-lookup"><span data-stu-id="98b81-145">Azure AD Graph</span></span> | <span data-ttu-id="98b81-146">Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="98b81-146">Microsoft Graph</span></span> |
|----|----|----|
| <span data-ttu-id="98b81-147">_Начальный запрос данных_</span><span class="sxs-lookup"><span data-stu-id="98b81-147">_Initial data request_</span></span> | <span data-ttu-id="98b81-148">Использует параметр запроса:</span><span class="sxs-lookup"><span data-stu-id="98b81-148">Uses a query parameter:</span></span><br>`GET /groups?deltaLink=` | <span data-ttu-id="98b81-149">Использует функцию:</span><span class="sxs-lookup"><span data-stu-id="98b81-149">Uses a function:</span></span> <br> `GET /groups/delta` |
| <span data-ttu-id="98b81-150">_Новые изменения_</span><span class="sxs-lookup"><span data-stu-id="98b81-150">_Get new changes_</span></span> | `GET /groups?deltaLink={deltaToken}` | `GET /groups/delta?$deltaToken={deltaToken}` |
| <span data-ttu-id="98b81-151">_Синхронизация с этого времени_</span><span class="sxs-lookup"><span data-stu-id="98b81-151">_Sync from now_</span></span> |<span data-ttu-id="98b81-152">Использует настраиваемый http-загот:</span><span class="sxs-lookup"><span data-stu-id="98b81-152">Uses a custom HTTP header:</span></span><br> `ocp-aad-dq-include-only-delta-token: true` | <span data-ttu-id="98b81-153">Использует параметр запроса:</span><span class="sxs-lookup"><span data-stu-id="98b81-153">Uses a query parameter:</span></span> <br> `GET /groups/delta?$deltaToken=latest` |
| <span data-ttu-id="98b81-154">_Отслеживание изменений для directoryObjects_</span><span class="sxs-lookup"><span data-stu-id="98b81-154">_Track changes for directoryObjects_</span></span> | <span data-ttu-id="98b81-155">Получает изменения для нескольких ресурсов (пользователя и группы) в одной операции:&nbsp;&nbsp;</span><span class="sxs-lookup"><span data-stu-id="98b81-155">Gets changes for multiple resource (user and group) in the same operation:&nbsp;&nbsp;</span></span><br> `GET /directoryObject?$filter=isof('User') or isof('Group')&deltaLink=` | <span data-ttu-id="98b81-156">Использует отдельные запросы с Помощью Microsoft Graph, по одному для каждого ресурса.</span><span class="sxs-lookup"><span data-stu-id="98b81-156">Uses separate queries with Microsoft Graph, one for each resource.</span></span> |
| <span data-ttu-id="98b81-157">_Изменение ресурсов и отношений_</span><span class="sxs-lookup"><span data-stu-id="98b81-157">_Get resource and relationship changes_</span></span> | <span data-ttu-id="98b81-158">Все запросы возвращают изменения ресурсов и отношений, если у ресурса есть связи.</span><span class="sxs-lookup"><span data-stu-id="98b81-158">All requests return resource and relationship changes, if the resource has relationships.</span></span> | `GET /groups/delta?$expand=members` |
| <span data-ttu-id="98b81-159">_Ответ, указывающий на новые и измененные элементы_</span><span class="sxs-lookup"><span data-stu-id="98b81-159">_Response indicating new and changed items_</span></span> | <ul><li><p><span data-ttu-id="98b81-160">Представляет вновь созданные экземпляры с использованием стандартного представления.</span><span class="sxs-lookup"><span data-stu-id="98b81-160">Represents newly created instances using their standard representation.</span></span></p></li><li><p><span data-ttu-id="98b81-161">Обновленные экземпляры представлены их id  с по крайней мере обновленными свойствами.</span><span class="sxs-lookup"><span data-stu-id="98b81-161">Updated instances are represented by their id with *at least* the properties that have been updated.</span></span> <span data-ttu-id="98b81-162">Другие свойства могут быть включены.</span><span class="sxs-lookup"><span data-stu-id="98b81-162">Other properties may be included.</span></span></p></li><li><p><span data-ttu-id="98b81-163">В качестве типа представлены `directoryLinkChange` отношения.</span><span class="sxs-lookup"><span data-stu-id="98b81-163">Relationships are represented as the `directoryLinkChange` type.</span></span></p></li></ul>|<ul><li><p><span data-ttu-id="98b81-164">Представляет вновь созданные экземпляры с использованием стандартного представления.</span><span class="sxs-lookup"><span data-stu-id="98b81-164">Represents newly created instances using their standard representation.</span></span></p></li><li><p><span data-ttu-id="98b81-165">Обновленные экземпляры представлены их id  с по крайней мере обновленными свойствами.</span><span class="sxs-lookup"><span data-stu-id="98b81-165">Updated instances are represented by their id with *at least* the properties that have been updated.</span></span> <span data-ttu-id="98b81-166">Другие свойства могут быть включены.</span><span class="sxs-lookup"><span data-stu-id="98b81-166">Other properties may be included.</span></span></p></li><li><p><span data-ttu-id="98b81-167">Отношения представлены в качестве аннотации в стандартном представлении ресурсов.</span><span class="sxs-lookup"><span data-stu-id="98b81-167">Relationships are represented as annotations on the standard resource representation.</span></span> <span data-ttu-id="98b81-168">В этих аннотациях используется формат, например для изменения `propertyName@delta` `members@delta` членства группы.</span><span class="sxs-lookup"><span data-stu-id="98b81-168">These annotations use the format `propertyName@delta`, for example `members@delta` for a group's membership changes.</span></span></p></li></ul> |
| <span data-ttu-id="98b81-169">_Ответ с указанием удаленных элементов_</span><span class="sxs-lookup"><span data-stu-id="98b81-169">_Response indicating  deleted items_</span></span>| <span data-ttu-id="98b81-170">Указывает удаленный элемент с дополнительным свойством *aad.isDeleted* set to true.</span><span class="sxs-lookup"><span data-stu-id="98b81-170">Indicates a deleted item with an additional property of *aad.isDeleted* set to true.</span></span> | <span data-ttu-id="98b81-171">Указывает удаленный элемент с \@ удаленной аннотацией.</span><span class="sxs-lookup"><span data-stu-id="98b81-171">Indicates a deleted item with the \@removed annotation.</span></span> <span data-ttu-id="98b81-172">Он также может содержать код причины, который указывает, удален ли элемент, но может быть восстановлен или удален навсегда.</span><span class="sxs-lookup"><span data-stu-id="98b81-172">It may also contain a reason code, which indicates if the item is deleted, but can be restored, or is permanently deleted.</span></span> |

<span data-ttu-id="98b81-173">Если в вашем приложении уже хранятся данные о состоянии, рассмотрите возможность использования показанной ранее "синхронизации" для управления переходом на запросы delta.</span><span class="sxs-lookup"><span data-stu-id="98b81-173">If your app is already storing state data, consider using the "sync from now" shown earlier to help manage the transition to delta queries.</span></span>

## <a name="batching"></a><span data-ttu-id="98b81-174">Пакетная обработка</span><span class="sxs-lookup"><span data-stu-id="98b81-174">Batching</span></span>

<span data-ttu-id="98b81-175">Azure AD Graph использовал систему, называемую многосерийными сообщениями MIME, для управления пакетами.</span><span class="sxs-lookup"><span data-stu-id="98b81-175">Azure AD Graph used a system called multi-part MIME messages to manage batching.</span></span>  <span data-ttu-id="98b81-176">Microsoft Graph использует [пакеты JSON](json-batching.md) для разрешения до 20 запросов в одной пакетной операции.</span><span class="sxs-lookup"><span data-stu-id="98b81-176">Microsoft Graph uses [JSON batching](json-batching.md) to permit up to 20 requests in a single batch operation.</span></span> <span data-ttu-id="98b81-177">Механизм пакетной обработки JSON значительно проще в использовании, особенно вместе с библиотеками размыкания JSON.</span><span class="sxs-lookup"><span data-stu-id="98b81-177">The JSON batching mechanism is significantly simpler to use, especially together with JSON parsing libraries.</span></span>  <span data-ttu-id="98b81-178">Кроме того, он позволяет последовательно секвенация пакетных операций.</span><span class="sxs-lookup"><span data-stu-id="98b81-178">It also allows for sequencing batch operations.</span></span>  <span data-ttu-id="98b81-179">Однако он не совместим с пакетным подходом Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-179">However, it is not backwards compatible with the Azure AD Graph batching approach.</span></span>

## <a name="next-steps"></a><span data-ttu-id="98b81-180">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="98b81-180">Next Steps</span></span>

- <span data-ttu-id="98b81-181">Узнайте о [различиях ресурсов](migrate-azure-ad-graph-resource-differences.md) между Azure AD Graph и Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98b81-181">Learn about [resource differences](migrate-azure-ad-graph-resource-differences.md) between Azure AD Graph and Microsoft Graph.</span></span>
- <span data-ttu-id="98b81-182">Снова [просмотрите контрольный](migrate-azure-ad-graph-planning-checklist.md) список.</span><span class="sxs-lookup"><span data-stu-id="98b81-182">Review the [checklist](migrate-azure-ad-graph-planning-checklist.md) again.</span></span>

<!-- {
  "type": "#page.annotation",
  "suppressions": [
    "Warning: /concepts/migrate-azure-ad-graph-feature-changes.md:
      Failed to parse any rows out of table with headers: |Task|Azure AD Graph|Microsoft Graph|"
  ],
}
-->