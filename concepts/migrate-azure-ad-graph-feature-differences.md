---
title: Различия функций между Azure AD Graph и Microsoft Graph
description: Описание различий в функциях между Azure Active Directory (Azure AD) API Graph и Microsoft API Graph, чтобы упростить перенос приложений.
author: dkershaw10
ms.localizationpriority: medium
ms.prod: applications
ms.openlocfilehash: 4ed6de06843d33c80dfcab28c885b7242ceede29
ms.sourcegitcommit: e48fe05125fe1e857225d20ab278352ff7f0911a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2022
ms.locfileid: "66555746"
---
# <a name="feature-differences-between-azure-ad-graph-and-microsoft-graph"></a>Различия функций между Azure AD Graph и Microsoft Graph

Эта статья является *частью шага 1. Ознакомьтесь с различиями API* в [процессе переноса приложений](migrate-azure-ad-graph-planning-checklist.md).

Многие функции в Microsoft Graph работают аналогично их аналогам Graph в Azure Active Directory (Azure AD). Однако некоторые из них были изменены или улучшены. Здесь вы узнаете, как адаптировать приложения, чтобы воспользоваться преимуществами этих различий.  Часто изменения незначительны, но стоит усилий.

В этой статье описывается, как Microsoft Graph обрабатывает:

- Расширения схемы каталога
- Разностные запросы
- Пакетная обработка

## <a name="directory-extensions"></a>Расширения каталогов

Если приложение использует Azure AD каталогов Graph, вы можете продолжать использовать те же базовые API (с URL-адресами запросов Microsoft Graph), чтобы:

- Управление определениями расширений каталогов с помощью [ресурса extensionProperty](/graph/api/resources/extensionproperty) и связанных методов.
- Получите доступные свойства расширения с помощью [действия getAvailableExtensionProperties](/graph/api/directoryobject-getavailableextensionproperties) .
- Чтение значений расширения с помощью GET и для пользователей только с помощью запроса `$select` через конечную `v1.0` точку
- Поиск значений расширений с помощью GET и `$filter`
- Обновление значений расширений с помощью PATCH
- Удаление значений расширения с помощью PATCH (имеет значение **NULL**)

Microsoft Graph предоставляет расширенные возможности разработки расширений схемы, которые в настоящее время не совместимы с расширениями каталогов Azure AD Graph. Дополнительные сведения см. в статье ["Выбор типа расширения для приложения"](extensibility-overview.md#choose-an-extension-type-for-your-application).

### <a name="recommended-migration-approach"></a>Рекомендуемый подход к миграции

Если Azure AD Graph использует расширения каталогов, выполните добавочный подход для переноса приложения в Microsoft Graph.

Сначала переключите приложение на использование вызовов Microsoft API Graph, но позвольте приложению продолжать использовать Azure AD каталогов Graph.

Затем можно переключиться на использование расширений схемы Microsoft Graph. В некоторых случаях переключение не подходит. Не переключаться, если:

- Приложение использует расширения каталогов, созданные с помощью AD Connect
- Приложение задает значения расширения каталога, используемые в утверждениях маркеров другими приложениями.
- Приложение задает значения расширения каталога, используемые в правилах динамического членства. 

>**ПРИМЕЧАНИЕ**. Использование свойств расширения схемы Microsoft Graph в качестве утверждений в маркере с использованием необязательных утверждений или в правиле динамического членства пока не поддерживается.

Чтобы перейти на более новую модель расширения схемы Microsoft Graph, вам потребуется:

- Определение новых определений расширений схемы с помощью Microsoft Graph.
- Обновите приложение для поддержки новых определений расширений схемы.
- Перенос данных из свойств расширения Azure AD схемы в новые свойства расширения схемы Microsoft Graph.  Автоматическая миграция данных не поддерживается.

## <a name="differential-queries"></a>Разностные запросы

Azure AD Graph и Microsoft Graph позволяют отслеживать изменения с помощью запросов.  Общий подход аналогичен двум API, но синтаксис отличается.

Azure AD Graph вызывает эти разностные запросы.  В Microsoft Graph это [разностные запросы](./delta-query-overview.md).

В следующей таблице перечислены основные сходства и различия.

|Разностный запрос |Azure AD Graph | Microsoft Graph |
|----|----|----|
| _Исходный запрос данных_ | Использует параметр запроса:<br>`GET /groups?deltaLink=` | Использует функцию: <br> `GET /groups/delta` |
| _Получение новых изменений_ | `GET /groups?deltaLink={deltaToken}` | `GET /groups/delta?$deltaToken={deltaToken}` |
| _Синхронизация с этого времени_ |Использует пользовательский заголовок HTTP:<br> `ocp-aad-dq-include-only-delta-token: true` | Использует параметр запроса: <br> `GET /groups/delta?$deltaToken=latest` |
| _Отслеживание изменений для объектов directoryObject_ | Возвращает изменения для нескольких ресурсов (пользователей и групп) в одной операции:&nbsp;&nbsp;<br> `GET /directoryObject?$filter=isof('User') or isof('Group')&deltaLink=` | Использует отдельные запросы с Microsoft Graph, по одному для каждого ресурса. |
| _Получение изменений ресурсов и связей_ | Все запросы возвращают изменения ресурсов и связей, если ресурс имеет связи. | `GET /groups/delta?$expand=members` |
| _Ответ, указывающий на новые и измененные элементы_ | <ul><li><p>Представляет только что созданные экземпляры с использованием стандартного представления.</p></li><li><p>Обновленные экземпляры представлены идентификатором по крайней мере со свойствами, которые были обновлены. Могут быть включены и другие свойства.</p></li><li><p>Связи представлены как `directoryLinkChange` тип.</p></li></ul>|<ul><li><p>Представляет только что созданные экземпляры с использованием стандартного представления.</p></li><li><p>Обновленные экземпляры представлены идентификатором по крайней мере со свойствами, которые были обновлены. Могут быть включены и другие свойства.</p></li><li><p>Связи представлены в виде заметок к стандартному представлению ресурсов. Эти заметки используют формат `propertyName@delta`, `members@delta` например для изменения членства в группе.</p></li></ul> |
| _Ответ, указывающий на удаленные элементы_| Указывает удаленный элемент с дополнительным свойством *aad.isDeleted* , которое имеет значение true. | Указывает удаленный элемент с удаленной \@заметкой. Он также может содержать код причины, который указывает, удален ли элемент, но может быть восстановлен или удален без возможности восстановления. |

Если в приложении уже хранятся данные о состоянии, рассмотрите возможность использования показанной ранее синхронизации для управления переходом на разностные запросы.

## <a name="batching"></a>Пакетная обработка

Azure AD Graph для управления пакетной обработкой используется система, называемая многопользовательскими сообщениями MIME.  Microsoft Graph использует [пакетную обработку JSON](json-batching.md) для разрешения до 20 запросов в одной пакетной операции. Механизм пакетной обработки JSON значительно проще в использовании, особенно вместе с библиотеками синтаксического анализа JSON.  Он также позволяет выполнять виртуализации пакетных операций.  Однако он не совместим с подходом пакетной обработки Azure AD Graph.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте о [различиях ресурсов](migrate-azure-ad-graph-resource-differences.md) между Azure AD Graph и Microsoft Graph.
- Проверьте [контрольный список](migrate-azure-ad-graph-planning-checklist.md) еще раз.

<!-- {
  "type": "#page.annotation",
  "suppressions": [
    "Warning: /concepts/migrate-azure-ad-graph-feature-changes.md:
      Failed to parse any rows out of table with headers: |Task|Azure AD Graph|Microsoft Graph|"
  ],
}
-->