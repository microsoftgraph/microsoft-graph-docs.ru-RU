---
title: Коды ошибок для API OneNote в Microsoft Graph
description: Найдите сведения о кодах ошибок, возвращаемых API OneNote в Microsoft Graph при сбое запроса, отправляемого через API.
author: jewan-microsoft
ms.localizationpriority: medium
ms.prod: onenote
ms.openlocfilehash: 378dae17b2c0668a33b50a1275f409f9b8e4d015
ms.sourcegitcommit: 7bc623e73fdfb970dbd0a62154d10bb2863afaf7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/07/2022
ms.locfileid: "66668148"
---
# <a name="error-codes-for-the-onenote-api-in-microsoft-graph"></a>Коды ошибок для API OneNote в Microsoft Graph

В этой статье описываются коды ошибок, возвращаемые API OneNote в Microsoft Graph при сбое запроса, отправляемого через API.

## <a name="error-response-example"></a>Пример ответа об ошибке

Если при отправке запроса возникает ошибка, API OneNote перестает выполнять запрос и возвращает ответ об ошибке в виде объекта JSON. Ответ об ошибке содержит соответствующий код ошибки, сообщение и ссылку на соответствующий раздел этой статьи. В приведенном ниже примере показано, как выглядит ответ об ошибке.

```json
{
   "error":{
      "code":"10002",
      "message":"The service is currently unavailable. Please try again later.",
      "innerError": {
        "requestId": "request-id",
        "date": "date-time"
      }
   }
}
```

Дополнительные сведения об ошибках Microsoft Graph см. в статье [Сообщения об ошибках и типы ресурсов ошибок Microsoft Graph](errors.md).

## <a name="codes-from-10001-to-19999"></a>Коды от 10001 до 19999

Служба работает с ошибками или отправляет информацию в приложение.

### <a name="10001"></a>10001
Произошла непредвиденная ошибка, и запрос не выполнен.

### <a name="10002"></a>10002
Служба в настоящее время недоступна.

### <a name="10003"></a>10003
Учетная запись текущего пользователя превысила максимальное число активных запросов. Приложению придется повторить запрос.

### <a name="10004"></a>10004
Служба не может создать страницу в запрашиваемом разделе, так как раздел защищен паролем.

### <a name="10005"></a>10005
В запросе превышено максимальное количество тегов изображений, в которых атрибут **data-render-src** содержит PDF-файл. См. статью [Добавление изображений и файлов](onenote-images-files.md).

### <a name="10006"></a>10006
API OneNote не удалось создать страницу в указанном разделе, потому что раздел поврежден.

### <a name="10007"></a>10007
Сервер слишком занят, чтобы обработать входящий запрос в данный момент. Повторите попытку позже.

### <a name="10008"></a>10008
Одна или несколько библиотек документов в хранилище OneDrive пользователя или группы содержит более 5000 элементов OneNote (записных книжек, разделов, групп разделов), и к ней невозможно отправлять запросы с помощью API. Убедитесь, что ни одна из библиотек документов пользователей и групп не содержит более 5000 элементов OneNote. Указания по устранению этой проблемы см. в [блоге разработчиков OneNote](/archive/blogs/onenotedev/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library).

### <a name="10012"></a>10012
Не удается создать или обновить объект, так как в библиотеке, содержащей записную книжку, требуется получать элементы для изменения, прежде чем редактировать их. Дополнительные сведения см. в статье [Как включить в библиотеке обязательное извлечение файлов](https://support.office.com/article/Configure-a-site-library-to-require-check-out-of-files-f63fcbdc-1db6-4eb7-a3eb-dd815500c9e7).

Отмените обязательное извлечение для этой библиотеки или переместите записную книжку.

### <a name="10013"></a>10013
Одна или более библиотек документов в OneDrive пользователя или группы содержит более 20 000 элементов и не может быть индексирована по запросу с помощью API. Убедитесь, что ни одна из библиотек документов пользователя или группы не содержит более 20 000 элементов. Действия по устранению рисков см. в [блоге разработчиков OneNote Dev](/archive/blogs/onenotedev/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library).

### <a name="10014"></a>10014
В данный момент служба Azure Key Vault слишком занята для обработки входящего запроса. Повторите попытку позже.

### <a name="10015"></a>10015
В настоящее время среда SharePoint недоступна. Повторите попытку позже.

### <a name="10016"></a>10016
Библиотека документов в хранилище OneDrive пользователя или группы превысила пороговое количество уникальных областей безопасности. Число уникальных областей безопасности для каждой библиотеки не может превышать 50 000.

### <a name="10017"></a>10017
Неправильный запрос.

### <a name="19999"></a>19999
Запрос не выполнен из-за неизвестной ошибки.

## <a name="codes-from-20001-to-29999"></a>Коды от 20001 до 29999

Код приложения допустил ошибку.

### <a name="20001"></a>20001

В запросе отсутствует необходимый раздел Presentation. Он должен быть только один. 

### <a name="20002"></a>20002
Запрос содержит две или более части Presentation. Он должен быть только один.

### <a name="20003"></a>20003
В разделе Presentation допускаются только типы контента text/HTML и application/XHTML+XML. 

### <a name="20004"></a>20004
HTML-код части "Presentation" содержит тег изображения с обоими наборами свойств: **src** и **data-render-src**. API будет игнорировать свойство **src** и использовать свойство **data-render-src**. 

### <a name="20005"></a>20005
URI запроса слишком длинный. Максимальный размер URI (включая все параметры и данные) составляет 16 КБ или 16 384 символов.

### <a name="20006"></a>20006
HTML-код раздела Presentation содержит тег image, в котором не заданы свойства src и **data-render-src**. API проигнорирует тег **image**. 

### <a name="20007"></a>20007
HTML-код раздела Presentation содержит строку даты и времени создания, которая не соответствует ни одному из допустимых форматов. 

### <a name="20008"></a>20008
Размер запроса превышает допустимый. 

### <a name="20009"></a>20009
Запрос содержит разделы с повторяющимися именами. Имена разделов должны быть уникальными. 

### <a name="20010"></a>20010
Для указанного типа контента не предоставлен заголовок Content-Disposition. 

### <a name="20011"></a>20011
Запрос содержит составные полезные данные неправильного формата. К возможным причинам этой ошибки относятся пустые строки, отсутствие последней строки, неправильно отформатированные разделители частей и т. д. Если вы создаете составное сообщение вручную, внимательно проверьте логику или используйте стороннюю библиотеку. 

### <a name="20012"></a>20012
В запросе не предоставлен тип контента для указанной части. 

### <a name="20013"></a>20013
В запросе не предоставлены заголовки Content-Type и Content-Disposition для указанной части. 

### <a name="20014"></a>20014
Длина части составного сообщения превышает максимальную (25 МБ). 

### <a name="20015"></a>20015
Количество частей составного сообщения превышает максимальное (500). 

### <a name="20016"></a>20016
Длина составного сообщения превышает максимальную (75 МБ). 

### <a name="20017"></a>20017
Неправильный формат MIME электронного сообщения. 

### <a name="20018"></a>20018
Неправильный формат MIME или элемента ICal для собрания. 

### <a name="20019"></a>20019
Элемент ICal не найден. 

### <a name="20020"></a>20020
В теле запроса обнаружен объект JSON неправильного формата. 

### <a name="20100"></a>20100
Ошибка синтаксиса запроса. 

### <a name="20101"></a>20101
Запрашиваемое свойство не существует.

### <a name="20102"></a>20102
Запрашиваемый ресурс не существует.

### <a name="20103"></a>20103
Оператор **expand** не поддерживается для этого запроса. См. раздел [Поддерживаемые параметры строки запроса OData](onenote-get-content.md#supported-odata-query-string-options).

### <a name="20104"></a>20104
Параметр запроса **pagelevel** поддерживается только для запроса коллекции страниц в разделе или конкретной страницы. Например:  

```http
GET ../sections/{id}/pages?pagelevel=true
GET ../pages/{id}?pagelevel=true
```

### <a name="20106"></a>20106
Запрос содержит неподдерживаемый оператор. 

### <a name="20108"></a>20108
Запрос содержит неподдерживаемые параметры запроса OData.

### <a name="20109"></a>20109
Полезные данные в PATCH-запросе неправильно построены.

### <a name="20110"></a>20110
Для запросов на создание страниц с частями данных необходимо составное содержимое с разделом Presentation. 

### <a name="20111"></a>20111
В запросе используется неподдерживаемая функция OData.

### <a name="20112"></a>20112
Запрос содержит недопустимый идентификатор для целевой сущности записной книжки, группы разделов, раздела или страницы.

### <a name="20113"></a>20113
Ресурс, заданный в запросе, был удален.

### <a name="20115"></a>20115
Имя содержит недопустимые символы. Имя записной книжки не может содержать следующие символы: `? * \ / : < > | ' "`

### <a name="20117"></a>20117
Элемент с таким именем уже существует в указанном месте.

### <a name="20119"></a>20119
HTML-код в разделе Presentation содержит атрибут **data-attachment**, который либо неправильно отформатирован либо содержит какие-либо из следующих недопустимых символов для имени файла: `\ / : * ? < > | "`. Запрос заменил значение, указанное в сообщении об ошибке.

### <a name="20120"></a>20120
В запросе указан целевой объект операции PATCH, который не удается найти.

### <a name="20121"></a>20121
Запрос содержит недопустимый аргумент PATCH. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20122"></a>20122
В запросе указано неподдерживаемое действие PATCH. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20123"></a>20123
PATCH-запросу не удается изменить указанную страницу.

### <a name="20124"></a>20124
Составной запрос PATCH не содержит раздела commands со структурой JSON действия PATCH. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20125"></a>20125
В PATCH-запросе не указаны никакие действия. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20126"></a>20126
Текст сообщения содержит неправильно отформатированный JSON или поля, неподдерживаемые для этой операции.

### <a name="20127"></a>20127
Запрос указывает имя неизвестного свойства.

### <a name="20128"></a>20128
Запрос содержит ошибку синтаксиса OData в месте, указанном в сообщении.

### <a name="20129"></a>20129
Запрос содержит параметр строки запроса **top** со слишком большим значением. Для запросов страниц максимальное значение составляет 100, а значение по умолчанию — 20.

### <a name="20130"></a>20130
Запрос содержит URI, указывающий на HTTP-ресурс, который не удается найти.

### <a name="20131"></a>20131
Запрос содержит недопустимое значение Content-Type. Используйте значение, указанное в сообщении. 

### <a name="20132"></a>20132
Запрос содержит недопустимый контент. Распространенные причины этой проблемы — отсутствие заголовка запроса Content-Type и/или отсутствие содержимого в теле запроса. 

### <a name="20133"></a>20133
В запросе указан неподдерживаемый целевой объект операции PATCH. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20134"></a>20134
В запросе указан недопустимый элемент в качестве целевого объекта для действия PATCH. Если для целевого объекта используется идентификатор **data-id**, убедитесь, что перед ним указан символ #. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20135"></a>20135
В запросе указан тип объекта, не поддерживаемый для операции PATCH. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20136"></a>20136
Запрос содержит недопустимый атрибут **data-render-src** или **data-render-method**, либо этот атрибут отсутствует. См. статью [Извлечение данных из записей](onenote-extract-data.md).

### <a name="20137"></a>20137
Конечная страница не поддерживает PATCH-запросы.

### <a name="20138"></a>20138
Целевой тип элемента в PATCH-запросе не поддерживает действие **append**. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20139"></a>20139
Запрос содержит недопустимое значение атрибута **data-tag**. См. раздел [Использование тегов заметки](onenote-note-tags.md).

### <a name="20140"></a>20140
Запрос содержит недопустимое значение состояния **data-tag**. Теги заметок для флажков могут находиться в состоянии **completed**. 

Пример.

```html
    <p data-tag="to-do:completed">To-do note tag in completed state (checked box in the UI)</p>
```
См. статью [Использование тегов заметок](onenote-note-tags.md).

### <a name="20141"></a>20141
Целевой объект в запросе PATCH не поддерживает указанное действие. См. статью [Обновление содержимого страницы](onenote-update-page.md).

### <a name="20142"></a>20142
Запрос содержит выражение **expand** для родительского объекта дочерних сущностей или дочернего объекта родительских сущностей. Такие выражения не поддерживаются. См. раздел [Поддерживаемые параметры строки запроса OData](onenote-get-content.md#supported-odata-query-string-options).

### <a name="20143"></a>20143
Недопустимый запрос OData.

### <a name="20144"></a>20144
Запрос содержит выражение **expand** для свойства, не связанного с навигацией. Расширять можно только свойства навигации.

### <a name="20145"></a>20145
Запрос содержит выражение **select** или **expand** с недопустимым термином.

### <a name="20146"></a>20146
Для элемента указан атрибут `style="position:absolute"`, но в элементе **body** не указан атрибут `data-absolute-enabled="true"`, необходимый для поддержки позиционирования. Все параметры положения будут игнорироваться. См. статью [Создание элементов с абсолютным положением](onenote-abs-pos.md).

### <a name="20147"></a>20147
Атрибут `style="position:absolute"` указан для элемента, не являющегося непосредственным дочерним объектом элемента **body**. Этот атрибут не поддерживается для таких элементов. Если это элемент **div**, **img** или **object**, сделайте его непосредственным дочерним объектом основного текста. В противном случае параметры положения будут проигнорированы, а содержимое будет отображаться внутри разделителя с абсолютным положением. См. статью [Создание элементов с абсолютным положением](onenote-abs-pos.md).

### <a name="20148"></a>20148
Атрибут `style="position:absolute"` указан для элемента, тип которого не поддерживает этот атрибут. Позиционирование поддерживается только для элементов **div**, **img** и **object**, являющихся непосредственными дочерними элементами основного текста. См. статью [Создание элементов с абсолютным положением](onenote-abs-pos.md).

### <a name="20149"></a>20149
Запрос указывает целевой элемент, который не удается найти.

### <a name="20150"></a>20150
Недопустимый запрос для этого типа проверки подлинности. Используйте путь `../me/onenote/`.

### <a name="20151"></a>20151
Недопустимый запрос для этого типа проверки подлинности. Используйте конечную точку `../me/onenote/section/{id}/pages`, чтобы создать страницу в определенном разделе.

### <a name="20152"></a>20152
Не указано значение name для элемента. Имя должно быть определено, и оно не может содержать только пробелы.

### <a name="20153"></a>20153
Имя объекта содержит недопустимые символы. Имя не может содержать следующие символы: `? * \ / : < > | & # " % ~`

### <a name="20154"></a>20154
Имя объекта не может начинаться с пробела.

### <a name="20155"></a>20155
Слишком длинное имя объекта. Максимальная длина для имен записных книжек составляет 128 символов. Максимальная длина имен других объектов составляет 50 символов.

### <a name="20156"></a>20156
Указанный идентификатор ресурса назначения не существует.

### <a name="20157"></a>20157
Указан недопустимый идентификатор объекта назначения.

### <a name="20158"></a>20158
Не удалось получить метаданные для URL-адреса сайта, указанного в запросе. Проверьте формат предоставленного URL-адреса. К поддерживаемым форматам относятся `https://domain.sharepoint.com/site-a` и `https://domain.com/sites/site-a`.

### <a name="20160"></a>20160
Не удается найти единую группу Office 365 с указанным ИД.

### <a name="20161"></a>20161
В контексте не указан действительный ИД пользователя. Одна из распространенных ошибок — передача PUID/CID в виде значения типа long, а не hex.

### <a name="20166"></a>20166
Приложение отправило слишком много запросов от имени пользователя за короткий период времени. Чтобы гарантировать стабильность и оперативность работы API OneNote, API возвращает код состояния 429 и это сообщение об ошибке, если обнаруживается, что приложение использует слишком много ресурсов. 

Дополнительные сведения см. в руководстве по регулированию для конкретной службы [Microsoft Graph](./throttling-limits.md).

### <a name="20168"></a>20168
Источник видео, указанный в запросе, не поддерживается. См. актуальный список [поддерживаемых сайтов с видео](onenote-images-files.md#adding-videos).


## <a name="codes-from-30001-to-39999"></a>Коды от 30001 до 39999
Что-то не так с учетной записью пользователя.

### <a name="30101"></a>30101
Для учетной записи пользователя превышена квота OneDrive. См. страницу [OneDrive](https://onedrive.live.com/about/).

### <a name="30102"></a>30102
В запрошенные раздел невозможно что-либо добавить, так как он достиг своего максимального размера.

### <a name="30103"></a>30103
Для выполнения запроса используется слишком много ресурсов. Либо целевая учетная запись пользователя содержит слишком большой набор данных, либо служба получает слишком много одновременных запросов для одного сайта (например, личного сайта пользователя или сайта группы).

### <a name="30104"></a>30104
Работа учетной записи пользователя была приостановлена.

### <a name="30105"></a>30105
Личный сайт пользователя в OneDrive для бизнеса не подготовлен к работе. Это необходимо для доступа к записным книжкам. Служба OneNote подготовит сайт к работе. Этот процесс может занять несколько минут.

### <a name="30106"></a>30106
OneDrive для бизнеса подготавливается к работе для пользователя.

### <a name="30108"></a>30108
Не удалось получить личное хранилище пользователя в OneDrive для бизнеса. В приведенной ниже таблице перечислены некоторые возможные причины.

| Причина | Решение |
|:------|:------|
| Личный сайт пользователя не подготовлен к работе. | Пользователь должен открыть OneDrive для бизнеса и следовать указаниям по подготовке сайта к работе. В случае сбоя он должен обратиться к администратору клиента Microsoft 365. |
| В данный момент личный сайт пользователя подготавливается к работе. | Попробуйте отправить запрос позже. |
| У пользователя нет действительной лицензии на OneDrive для бизнеса. | Пользователь должен обратиться к администратору клиента Microsoft 365. |
| Не удается отправить запрос из-за проблем с сетью. | Попробуйте отправить запрос позже. |

### <a name="30109"></a>30109
Некоторые пользователи, указанные в запросе, не существуют.

### <a name="30110"></a>30110
Для этого клиента не зарегистрированы службы сведений об учащихся.

### <a name="30111"></a>30111
Возникла общая ошибка служб сведений об учащихся.

### <a name="30112"></a>30112
Запрос влияет на нескольких пользователей с одинаковыми именами.

### <a name="30113"></a>30113
Для записной книжки не разрешены приглашения.

### <a name="30114"></a>30114
Отсутствует обязательный параметр.

## <a name="codes-from-40001-to-49999"></a>Коды от 40001 до 49999
У пользователя или приложения нет необходимых разрешений.

### <a name="40001"></a>40001
Запрос не содержит действительный маркер OAuth. См. раздел [Разрешения для заметок](permissions-reference.md#notes-permissions).

### <a name="40002"></a>40002
У пользователя нет разрешения на запись в указанном расположении.

### <a name="40003"></a>40003
У пользователя нет разрешения на доступ к запрашиваемому ресурсу.

### <a name="40004"></a>40004
Область действия маркера OAuth недостаточна для выполнения запрашиваемого действия. См. раздел [Разрешения для заметок](permissions-reference.md#notes-permissions).

### <a name="40006"></a>40006 
Область действия маркера OAuth недостаточна для выполнения запрашиваемого действия. В частности, это относится к разрешению на редактирование. См. раздел [Разрешения для заметок](permissions-reference.md#notes-permissions).

### <a name="40007"></a>40007
У пользователя нет разрешений на доступ к этому ресурсу.

### <a name="40008"></a>40008
Доступ к этому ресурсу запрещен.

### <a name="40009"></a>40009
Контейнер уже используется другим ресурсом.

## <a name="see-also"></a>См. также

- [Сообщения об ошибках и типы ресурсов ошибок Microsoft Graph](errors.md)
- [Справочные материалы по API-интерфейсам OneNote](/graph/api/resources/onenote)
